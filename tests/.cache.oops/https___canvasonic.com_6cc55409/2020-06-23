<!-- 'appvisitor' -->



<!DOCTYPE html>
<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="viewport" content="initial-scale=1, maximum-scale=1">
<meta name="csrf-token" content="kWfNVtc4nL9h6LjqdVKzMincsnv7Bb6USxjqA0Fj" />

<head>
<meta name="msvalidate.01" content="8CC6B8DEAA28AF1A4291CE6B15D6A60F" />
<title>Canvasonic - YouTube Player</title>
<meta name="google-site-verification" content="CKuBNwUA8KP8F2SLVcxGZdH9LlXndhwWJBpSctb-ly8" />
<meta name="description" content=" Watch YouTube Videos Organized by Category on Canvasonic, the Alternative YouTube Player">
<link rel="icon" href=https://canvasonic.com/favicon.png  type="image/png" sizes="16x16">
<!-- <base target="_blank"> -->
<!-- OpenGraph -->
<meta property="og:title" content="Canvasonic - YouTube Player">
<meta property="og:site_name" content="canvasonic.com">
<meta property="og:url" content="https://canvasonic.com">
<meta property="og:description" content=" Watch YouTube Videos Organized by Category on Canvasonic, the Alternative YouTube Player">
<meta property="og:type" content="video.other">
<!-- Twitter -->
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@canvasonic" />
<meta name="twitter:title" content="Canvasonic - YouTube Player">
<meta name="twitter:description" content=" Watch YouTube Videos Organized by Category on Canvasonic, the Alternative YouTube Player">
<!-- Google Data Schema  -->
<meta itemprop="name" content="Canvasonic - YouTube Player">


<!-- <link rel='manifest' href='/manifest.webmanifest'> -->

<link rel="stylesheet" href="https://canvasonic.com/assets/css/jqm/jquery.mobile.min.css" />

<link rel="stylesheet" href="https://canvasonic.com/assets/css/jqm/listview-grid.css" />

<link rel="stylesheet" href="https://canvasonic.com/assets/css/swipebox/swipebox.min.css" />
<link rel="stylesheet" href="https://canvasonic.com/assets/css/sly/sly.min.css" />
<link rel="stylesheet" href="https://canvasonic.com/assets/css/font-awesome/css/font-awesome.min.css">

<style>
.ui-listview>.ui-li-static, .ui-listview>.ui-li-divider, .ui-listview>li>span.ui-btn
{
    margin: 0;
    display: block;
    position: relative;
    text-align: left;
    text-overflow: ellipsis;
    overflow: hidden;
    white-space: nowrap;
}
.vtp-svg-shadow {
    stroke: #000;
    stroke-opacity: 1;
    stroke-width: 2px;
    fill: none;
}
.screenBtn.screenSizeBtn:hover {
    opacity: 0.45;
    cursor: pointer;
}
.ui-controlgroup, fieldset.ui-controlgroup {float: left;}
div.timeFormatText {
    float: right;
    font-size: 14px;
    line-height: 1.3;
    font-family: sans-serif;
	color: #757575; /*  #bbbbbb; #767676; */
    margin: 1.2em -190px 0 0; /*   margin: 1.5em 0; */
	
}
span#itemTitle a{color: #cacaca;	font-weight: 500; text-decoration: none;}
span#itemTitle:hover { border-bottom: rgba(215, 215, 215, 0.63); border-bottom-width: thin; border-bottom-style: outset; }
.iteminfo-r {float: right;padding-right: 30px;}
div#popupReader{height: 96vh;}
div#popupReader-popup{top: 19.5px;}
/* .ui-btn{ cursor: default; } */
p{color:#999}.ui-li-icon{left:1px;max-height:none;max-width:280px;position:absolute;top:0}.ui-content{ /*background:url('/assets/img/bg-body4.jpg') repeat 50% 0;*/ background-color: rgb(25, 25, 25); min-height:100vh;padding-right:1px;padding-left:1px}.cardView-page .ui-listview{max-width:79%}.cardView-page .ui-listview li.ui-li-has-thumb .ui-li-thumb{max-width:183px}span#itemTitle{border-bottom:rgba(138,138,138,.57);border-bottom-width:thin;border-bottom-style:outset}span#itemDescription{display:block;font-size:14px;font-weight:100;margin-top:10px;top:0;margin-left:2px;margin-bottom:13px;color:rgba(153, 153, 153, 0.55)}span#itemInfoBar{display:block;font-size:13px;font-weight:100;bottom:0;margin-left:24px;margin-bottom:13px;color:#616161;border-top:rgba(58,58,58,.28);border-top-width:thin;padding-top:11px;border-top-style:outset;position:absolute;width:95%}span#itemImgBlock img{width:25px;opacity:.6}span#itemImgBlock{bottom:0;margin-left:-8px;margin-bottom:9px;position:absolute;border-radius:50%;overflow:hidden;height:25px;font-size: 18px;color:#0037a0bf;}.ui-header.ui-bar-inherit.ui-bar-b.ui-header-fixed{background-color:rgb(19,19,19);box-shadow:0 5px 10px -5px rgba(0,0,0,.86);z-index: 1!important;}#ul_id .ui-btn{padding-top:0;padding-bottom:0;background-color:#171717}#ul_id .ui-li{height:50%}h3.ui-collapsible-heading span{padding-left:5px;padding-top:4px;display:block}a.ui-btn.ui-btn-icon-right.ui-icon-delete{background-color:#232323;margin-bottom:7px}a.inline.coll_head_butt.ui-link.ui-btn.ui-btn-b.ui-icon-carat-r.ui-btn-icon-notext.ui-shadow.ui-corner-all{float:right;height:20px;width:20px}.ui-input-search{margin-left:14px;margin-right:14px}.ui-panel-inner>.ui-listview-inset{margin:0em 0}.ui-panel.ui-panel-open{position:fixed}.ui-panel-inner{position:absolute;top:1px;left:0;right:0;bottom:0;overflow:scroll;-webkit-overflow-scrolling:touch}.ui-input-search>input{line-height:1.6em;padding:.5em}.ui-input-search>input{padding-left:2em}ul.cmdItemBox{padding:5px 20px 5px 20px;list-style-type:none;overflow:hidden;overflow-y:scroll;height:88%}li.cmdListItem{background-color:rgba(4,6,6,.15);padding:10px;opacity:.7;user-select:none;cursor:pointer;overflow:auto}li.cmdListItem:nth-child(odd){background-color:rgba(27,20,62,.13)}li.cmdListItem:hover{opacity:1}span.cmdIndex{float:right;font-size:12px;font-weight:300;color:#444;padding:5px}.ui-input-search:after{width:18px;height:18px;margin-top:-8px;left:.5em}.ui-alt-icon.ui-icon-search:after,.ui-alt-icon .ui-icon-search:after,.ui-input-search:after{background-size:18px!important}.ui-content .ui-btn{border:black!important}.ui-content .ui-btn.ui-btn-b{border:black!important;background-color:#0e0e0e!important}#controller-bar{height:100%;background:#212121;opacity:.6;display:flex;padding-top:1px}div#controller-bar .flexChild{flex:1}div.playControlBox{text-align:center;opacity:.9;}div.controlBtnBlock { margin: -.1em 1.2em 0 0; }div.playControlBox span{padding:0 1.5px 0 1.5px;-webkit-user-select:none}.conPlayBtn span{height:44px;width:44px;display:inline-block;margin:8px 5px 8px 5px;background-image:url(https://canvasonic.com/assets/img/controller/Play.png);background-repeat:no-repeat;background-position:50% 50%;background-size: 44px 44px;}.conPrevBtn span{height:44px;width:44px;display:inline-block;margin:8px 0 8px 0;background-image:url(https://canvasonic.com/assets/img/controller/prevIcon.png);background-repeat:no-repeat;background-position:50% 50%;background-size:35px 35px;}.conNextBtn span{height:44px;width:44px;display:inline-block;margin:8px 0 8px 0;background-image:url(https://canvasonic.com/assets/img/controller/nextIcon.png);background-repeat:no-repeat;background-position:50% 50%;background-size:35px 35px;}div.nowPlayingTrackPrv{overflow:auto;margin-top:-1}div.nowPlayingTrackPrv #thumbnailImg{float:left}div.nowPlayingTrackPrv #thumbnailImg img{display:block;width:105;height:60px;filter:alpha(opacity=100);-webkit-user-select:none}div.nowPlayingTrackPrv .nowTrackInfo{overflow:auto}div.nowPlayingTrackPrv #fileName{background:none repeat scroll 0 0 rgba(21,21,21,.95);padding:6px}div.nowPlayingTrackPrv #fileName p{margin:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;opacity:.99;font-weight:100;max-width:95%;font-size::14}div.nowPlayingTrackPrv .artistName{padding:0 0 2px 5px;font-size:small}div.nowPlayingTrackPrv .artistName p{margin:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;opacity:.99;font-weight:100;padding:6px 0 2px 5px}div.nowPlayingTrackPrv .playerOption{height:61px;width:63px;background-color:rgba(255,255,255,.03);display:inline;float:left}.playerOption .screenBtn{height:inherit; padding:2% 20% 0% 22%; opacity: 0.25; }div#rootContainer{background-color:rgb(25, 25, 25);overflow:hidden;min-height:100vh}.ui-header{padding-top:6px}.ui-header.ui-header-fixed.ui-fixed-hidden{padding-top:6px!important}.ui-listview .ui-li-has-thumb p{min-height:15%}.app-page .ui-listview li .ui-btn{border-radius:0;-webkit-border-radius:0}span.feedImgBlock{display:block;position:absolute;left:0;height:190px;width:337px}span.feedImgBlock::before{position:absolute;top:50%;left:50%;transform:translate(-10%,-10%);-webkit-transform:translate(-50%,-50%);content:"\f04b";font-family:FontAwesome;font-size:100px;color:#fff;opacity:.5;text-shadow:0 0 30px rgba(0,0,0,.5);z-index:3}.actionItem{background-color:#0C0C0C!important}.ui-li-aside{background-color:#0D0D0D!important}#popupLogin-popup{width:33%}.quickButtons{z-index:1000;margin:.2em 0 0 .5em}.show_sliderbar .ui-slider{height:inherit;margin-left:20%;margin-right:20%;margin-bottom:0;margin-top:0;background-color:rgba(255,0,0,0);cursor:pointer;cursor:hand}.show_sliderbar .ui-slider-track.ui-mini{height:3px;top:0;margin:6px 20% 6px 20%;opacity:.6}.show_sliderbar .ui-slider-input{height:6px!important;margin:0;padding:0;display:none}.show_sliderbar .ui-slider .ui-slider-handle{display:none}.show_sliderbar .ui-slider .ui-slider-track{background-color:rgba(29,129,162,.74);margin-right:0%;margin-left:0%;opacity:.4}.show_sliderbar .ui-slider-bg.ui-btn-active{background-color:rgba(34,170,221,.8);opacity:.8;overflow:hidden}.show_sliderbar .ui-slider-bg.ui-btn-active::after{content:close-quote;display:block;float:right;height:inherit;width:38px;background:linear-gradient(to right,rgba(34,170,221,.2),rgba(41,184,229,.8) 50%,rgba(191,231,247,.8) 100%)}.ui-slider .ui-slider-track.ui-mini:hover{cursor:pointer}div#timeSliderArrowBox{height:22px;position:absolute;background-color:rgba(28,31,31,.99);bottom:17px;left:581px;border-radius:2px}div#timeSliderArrowBox::after{content:close-quote;width:0;height:0;border-left:6px solid transparent;border-right:6px solid transparent;border-top:6px solid #1f1f1f;top:22px;left:50%;margin-left:-6px;position:absolute}p.timePop{font-size:11px;padding:8px 3px 8px 3px;margin-top:-4px!important;color:#396767!important;display:inline-block;cursor:default}.delBtn{float:left;padding:0 5px;height:100%;margin-top:28%}.delBtn:before{content:"\2716";opacity:.5;position:sticky;bottom:10%;left:0%;width:100%;font-size:13px}.playSlyBtn{text-align:center;margin-left:15%;height:100%;width:40%;background:linear-gradient(to bottom,rgba(94,160,214,0) 0%,rgba(255,255,255,0) 1%,rgba(255,255,255,.41) 100%);padding:0 10px;position:inherit}.playSlyBtn:before{content:"\25B8";opacity:1;font-size:40.5px;position:sticky;bottom:25px;left:3px;width:100%;height:100%;margin-left: -15%;}.overlayBtnContainer span.flexChild{flex:1}span.flexChild div:hover{background:linear-gradient(to bottom,rgba(94,160,214,0) 0%,rgba(255,255,255,.63) 100%)}.overlayBtnContainer{display:flex;height:40%;background:linear-gradient(to bottom,rgb(6,6,6) 0%,rgba(255,255,255,0) 1%,rgb(0,0,0) 100%)}.overlayBoxBtn{height:60px;background-color:rgba(0,255,255,0);text-align:center}span.slyImgOverlay{content:close-quote;width:178px;height:99px;margin:auto;z-index:7;position:absolute;display:none;}div#leftpanel1{background-color:#2a2a2aad}div#leftpanel1 ul.ui-listview li{opacity:.75;background-color:#2a2a2aad!important}div#leftpanel1 ul.ui-listview li h3 a{background-color:#333333d1!important}div#leftpanel1 ul.ui-listview li h3 a:after{opacity:.45}div#leftpanel1 #lpanelclose{opacity:.5}div#leftpanel1 #lpanelclose a{color:transparent}
div#conPanel{display:none}div.conPSideContainer{background-color:rgba(51,204,255,0);width:21%;height:inherit}div#conPLeftContainer{float:left}div#conPRightContainer{float:right}.miniPlayScreen{width:571px!important;height:322px!important;right:0.05%!important;top:auto!important;z-index:1101!important;bottom:72px}.miniPlayScreen .slide .swipebox-video-container{padding:0 0 1px 0px!important}.ui-li-has-thumb .ui-icon-bars:after{opacity:.5!important}#footer{position:fixed;left:0;bottom:0;height:61px;width:100%;background:#000;opacity:.98;z-index:200!important;user-select:none;border:0;-webkit-transform:translateZ(0);z-index:1000}.ui-panel.ui-panel-open{position:fixed}.ui-panel-inner{position:absolute;top:1px;left:0;right:0;bottom:0;overflow:hidden;-webkit-overflow-scrolling:touch}.ui-panel-inner:hover{overflow-y:auto}.panel-wrapper{position:fixed;bottom:61px;width:100%;z-index:100!important;-webkit-transform:translate3d(0,0,0)}img.thmbImg{width:18%;float:left;margin:0 20px 0 0}a.ui-li-thumb.fname p{display:inline-block;margin:5px 0 0 0}body.dragging,body.dragging *{cursor:move!important}.dragged{position:absolute}ul.clearfix li.dragged{position:absolute;opacity:.9;z-index:2000}ul.clearfix li.placeholder{position:relative}ul.clearfix li.placeholder:before{content:close-quote;position:absolute;width:0;height:0;border:5px solid transparent;border-top-color:red;top:0;margin-left:-5px;border-bottom:none}video{width:100%;height:100%;position:absolute;top:0;object-fit:cover;left:0}ul.ui-listview.panel-btnlist{width:272px}.ui-panel-inner .ui-controlgroup-controls{width:240px;margin-top:30px;opacity:.6}.ui-listview>.ui-li-static{padding:.05em 1em!important}::-webkit-scrollbar{width:9px;height:6px}::-webkit-scrollbar-track-piece{background-color:#3b3b3b;-webkit-border-radius:0}::-webkit-scrollbar-thumb{-webkit-border-radius:1px;border-radius:1px;background:rgba(118,118,118,.4)}::-webkit-scrollbar-thumb:window-inactive{background:rgba(118,118,118,.4)}body{margin:0;padding:0 0 0 4px;background-color:black;margin:0;padding:0;-webkit-touch-callout:none!important}
.tooltip{position:relative;display:inline-block;border-bottom:1px dotted #000}.tooltip .tooltiptext{visibility:hidden;width:110px;background-color:#000;color:#868686;text-align:center;border-radius:0px;padding:5px 0;position:absolute;z-index:1;bottom:150%;left:31%;margin-left:-60px}.tooltip .tooltiptext::after{content:"";position:absolute;top:100%;left:50%;margin-left:-5px;border-width:5px;border-style:solid;border-color:#000 transparent transparent}.tooltip:hover .tooltiptext{visibility:visible}

@media  all and (max-width: 1024px) and (min-width: 700px) {
  div.timeFormatText {
       margin: 1.4em -1.5em 0 0;
  }
}

</style>

<script src="https://canvasonic.com/build/js/jquery-2.1.4.min.js"></script>
<!-- <script src=https://canvasonic.com/build/js/jquery-2.1.4.min.js></script> -->
<script src="https://canvasonic.com/build/js/jquery.mobile-1.4.5.min.js"></script>

<script src="https://canvasonic.com/build/js/swipebox/jquery.swipebox.mini.js"></script>
<script src="https://canvasonic.com/build/js/swipebox/ios-orientationchange-fix.js"></script>
<script src="https://canvasonic.com/build/js/jq-sortable/jquery-sortable-min.js"></script>

<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/scrollify/1.0.17/jquery.scrollify.min.js"></script> -->
<script src="https://canvasonic.com/build/js/scrollify/jquery.scrollify.min.js"></script>
<script src="https://canvasonic.com/build/js/scrollify/scrollify.code.js"></script>
<script src="https://canvasonic.com/build/js/webplayerAPI/webplayerAPI.code.js"></script>

</head>

<body class='ui-mobile-viewport ui-overlay-b'>
<span class="viewSection" ></span>
<div data-role='page' id='article1' data-theme='b' class='ui-page ui-page-theme-b ui-page-active '>

	<div data-role='header' data-theme='b' data-position='fixed' data-id='header' class='ui-header ui-bar-inherit' data-tap-toggle-blacklist=".panel-wrapper, .ui-li-has-alt, .nowPlayingTrackPrv, .quickButtons, a, button, input, select, textarea, .ui-header-fixed, .ui-footer-fixed, .ui-flipswitch, .ui-popup, .ui-panel, .ui-panel-dismiss-open" >
		<a href="#leftpanel1" id="panelLBtn" data-icon="bars" data-iconpos="notext" data-shadow="false" data-iconshadow="false" class="ui-link ui-btn-left ui-btn ui-icon-bars ui-btn-icon-notext ui-corner-all" data-role="button" role="button">Menu</a>
	<div class='searchBoxDiv'>
		<form method='post' id='app-form'>
		<input type="hidden" name="_token" value="kWfNVtc4nL9h6LjqdVKzMincsnv7Bb6USxjqA0Fj" />
		<input type='hidden' name='webControl' value='searchVid' />

		<input type='search' name='playID' id='search-mini' value='' data-mini='false' placeholder='Search ...' autocapitalize="off" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
		<input type='hidden' id='searchKey' name='qkey'  value=''  />
 <input type='hidden' id='nextPageTokenInput' name='nextPageToken' value='' />
 <input type="hidden" name="_tokenlink" value="">
	<input type="hidden" name="action" value="search" />
	<input type="hidden" name="mod" value="catPlayer" />
	<input type="hidden" name="scope" value="user" />
				</form>
				</div>
<div id="conPanel">
<div id="conPLeftContainer" class="conPSideContainer"></div>
<div id="conPCenterContainer">
<ul class='cmdItemBox'></ul>
</div>
<div id="conPRightContainer" class="conPSideContainer"></div>
</div>


	<!-- Mic-Button In Top -->

	<!-- END Mic-Button In Top -->
	</div>

			<!--	 <diiv class="ui-panel-wrapper"> -->

<div data-role='content' class='ui-content' role='main'>
<div id="rootContainer">
	<div id="listBackBox">
		<div id="page-ui" class="app-page listView-page" >
				<!-- <diiv class="ui-block-a"> -->
				<ul id='ul_id' data-role='listview' data-split-theme='b' data-inset='true' class='ui-listview ui-listview-inset'>
				
				
				</ul>
		</div>
	</div>
	<div id="page-ui" class="app-page cardView-page" >
			<!-- item listing for local media library -->
				<ul id='ul_id' data-role='listview' data-inset='true' class='ui-listview ui-listview-inset'></ul>
<div id="itemVMenu"><span class="cornerImg">
<!-- <img src="" /> -->
</span><span class="itemVInfoBlock"></span></div>
</div>
</div><!-- #rootContainer -->
</div><!-- .ui-content -->




<div id="masterFooter">
<div class="panel-wrapper">
				<div class="slyWrap">
					<div class="scrollbar">
					<div class="handle">
						<div class="mousearea"></div>
					</div>
				 </div>
			   <div class="frame" id="basic">
			     <ul class="clearfix">
			       <li>0<img src="" class="qItemImg"></li>
			       <li>1<img src="" class="qItemImg"></li>
			       <li>2<img src="" class="qItemImg"></li>
			       <li>3<img src="" class="qItemImg"></li>
			       <li>4<img src="" class="qItemImg"></li>
			       <li>5<img src="" class="qItemImg"></li>
			       <li>6<img src="" class="qItemImg"></li>
			       <li>7<img src="" class="qItemImg"></li>
			       <li>8<img src="" class="qItemImg"></li>
			       <li>9<img src="" class="qItemImg"></li>
			       <li>10<img src="" class="qItemImg"></li>
			       <li>11<img src="" class="qItemImg"></li>
			       <li>12<img src="" class="qItemImg"></li>
			       <li>13<img src="" class="qItemImg"></li>
			       <li>14<img src="" class="qItemImg"></li>
			       <li>15<img src="" class="qItemImg"></li>
			     </ul>
			   </div>


			   <div class="controls center">
			     <button class="btn prevPage"><i class="icon-chevron-left"></i><i class="icon-chevron-left"></i> page</button>
			     <button class="btn prev"><i class="icon-chevron-left"></i> item</button>
			     <button class="btn backward"><i class="icon-chevron-left"></i> move</button>

			     <div class="btn-group">
			       <button class="btn toStart">toStart</button>
			       <button class="btn toCenter">toCenter</button>
			       <button class="btn toEnd">toEnd</button>
			     </div>

			     <div class="btn-group">
			       <button class="btn toStart" data-item="10"><strong>10</strong> toStart</button>
			       <button class="btn toCenter" data-item="10"><strong>10</strong> toCenter</button>
			       <button class="btn toEnd" data-item="10"><strong>10</strong> toEnd</button>
			     </div>

			     <div class="btn-group">
			       <button class="btn add"><i class="icon-plus-sign"></i></button>
			       <button class="btn remove"><i class="icon-minus-sign"></i></button>
			     </div>

			     <button class="btn forward">move <i class="icon-chevron-right"></i></button>
			     <button class="btn next">item <i class="icon-chevron-right"></i></button>
			     <button class="btn nextPage">page <i class="icon-chevron-right"></i><i class="icon-chevron-right"></i></button>
			   </div>
			 </div>
						<!-- only load this HTML in #targetElement if Desktop using js -->
						
<div id="info" class="" >
<span style="visibility: hidden; display: none;" >
             <p id="info_start">Click on Thumbnail to Play.</p>
             <p id="info_speak_now">Speak now.</p>
             <p id="info_final_words"><span class="voicein final" id="final_span"></span></p>
             <p id="info_speaking_words"><span class="interim" id="interim_span"></span></p>
             <p id="info_no_speech">No speech was detected. You may need to adjust your
               <a href="//support.google.com/chrome/bin/answer.py?hl=en&amp;answer=1407892">
                 microphone settings</a>.</p>
             <p id="info_no_microphone" style="display:none">
               No microphone was found. Ensure that a microphone is installed and that
               <a href="//support.google.com/chrome/bin/answer.py?hl=en&amp;answer=1407892">
               microphone settings</a> are configured correctly.
               </p>
             <p id="info_allow">Click the "Allow" button above to enable your microphone.</p>
             <p id="info_denied">Permission to use microphone was denied.</p>
             <p id="info_blocked">Permission to use microphone is blocked. To change,
               go to chrome://settings/contentExceptions#media-stream</p>
             <p id="info_upgrade">Web Speech API is not supported by this browser.
                Upgrade to <a href="//www.google.com/chrome">Chrome</a>
                version 25 or later.</p>
</span>
                <div id="show_sliderbar" class="show_sliderbar">
                  <!-- <div data-role="fieldcontain" > -->
                    <!-- class="ui-field-contain ui-body ui-br" -->
  <input type="range" name="slider-mini" id="slider-mini" value="25" min="0" max="100" data-highlight="true" data-mini="true">
  <div id="timeSliderArrowBox" ><p class="timePop">3:20</p></div>
                  <!-- </div> -->
                </div>
<div id="flexInfoBar" ></div>

           <div class="compact marquee voiceBox"  style="visibility: hidden;display: none;">

             <div id="div_language" style="visibility: hidden;">
               <select id="select_language" onchange="updateCountry()"></select>
               &nbsp;&nbsp;
               <select id="select_dialect"></select>
             </div>
          </div>
</div>

</div> <!-- "panel-wrapper" END -->

<div id="targetElement" class="red"></div>

<div data-role="footer" id="footer" >
	<div id="controller-bar">

			 <div class="quickButtons flexChild">
			 <div data-role="controlgroup" data-type="horizontal" class="ui-controlgroup ui-controlgroup-horizontal ui-corner-all">
				<a href="#" data-icon="recycle" data-iconpos="notext" data-shadow="false" data-iconshadow="false" class="ui-link ui-btn ui-icon-recycle ui-btn-icon-notext ui-corner-all syncSlyQListBtn" data-role="button" role="button">Menu</a>
				<a href="#" data-icon="carat-r" data-iconpos="notext" data-shadow="false" data-iconshadow="false" class="ui-link	ui-btn ui-icon-carat-r ui-btn-icon-notext ui-corner-all quickPlayBtn" data-role="button" role="button">Play</a>
				<a href="#" data-icon="action" data-iconpos="notext" data-shadow="false" data-iconshadow="false" class="ui-link ui-btn ui-icon-action ui-btn-icon-notext ui-corner-all nextPlayBtn" data-role="button" role="button">Play</a>
				<a href="#" data-icon="arrow-u-r" data-iconpos="notext" data-shadow="false" data-iconshadow="false" class="ui-link ui-btn arrow-u-r ui-btn-icon-notext ui-corner-all screenSizeBtn" data-role="button" role="button">Screen</a>
				<a href="#" data-icon="carat-u" data-iconpos="notext" data-shadow="false" data-iconshadow="false" class="ui-link ui-btn ui-icon-video ui-btn-icon-notext ui-corner-all showSliderConBtn" data-role="button" role="button">Show Slider</a>
				
			</div>	 
			<div class="timeFormatText">0:00:00</div>
			</div>

				<div class="playControlBox flexChild">
				 <div class="controlBtnBlock">
					<a class='conPrevBtn'><span alt="Previous"></span></a>
					<a class='conPlayBtn'	><span alt="Play"></span></a>
					<a class='conNextBtn'><span alt="Next"></span></a>
				 </div>
				</div>

				<div class="nowPlayingTrackPrv flexChild">
						<div class="playerOption screenSizeBtn">
							<div class="screenBtn screenSizeBtn">
							<svg height="100%" version="1.1" viewBox="0 0 36 36" width="100%"><use class="vtp-svg-shadow" ></use><path d="M25,17 L17,17 L17,23 L25,23 L25,17 L25,17 Z M29,25 L29,10.98 C29,9.88 28.1,9 27,9 L9,9 C7.9,9 7,9.88 7,10.98 L7,25 C7,26.1 7.9,27 9,27 L27,27 C28.1,27 29,26.1 29,25 L29,25 Z M27,25.02 L9,25.02 L9,10.97 L27,10.97 L27,25.02 L27,25.02 Z" fill="#fff"></path></svg>
							</div>
						</div>
										<!-- <div id="thumbnailImg"><img src=https://canvasonic.com/assets/img/logo_1.jpg style="width: 60px;"></div> -->
									
										<div id="thumbnailImg"><img src='https://i.ytimg.com/vi/-O5kNPlUV7w/mqdefault.jpg' style="width: 105px;"></div>
										<div class="nowTrackInfo">
										<div id="fileName" class="trackName"><p>Why Beautiful Things Make us Happy – Beauty Explained</p></div> 
										<div id="artistName" class="artistName"><p>Kurzgesagt – In a Nutshell</p></div> 
										</div>

									</div>

		</div>
</div>
</div>		<!-- 'masterFooter' </diiv> -->
				<!-- </diiv> -->




		<!-- iFrame Popup -->	
		<div data-role="popup" id="popupReader" data-overlay-theme="a" data-theme="a" data-corners="false" data-shadow="false" data-tolerance="15,15" data-history="false" style="border-width: 0px;">
		<a href="#" data-rel="back" class="ui-btn ui-btn-b ui-corner-all ui-shadow ui-btn-a ui-icon-delete ui-btn-icon-notext ui-btn-right">Close</a>
		<iframe id="viewer" src="" width="785" height="96%" seamless="" style="border-width: 0px;"></iframe>
		 <!-- height="920" -->
		</div>
 
	</div> <!-- data-role='page' -->

	<div data-role="panel" id="leftpanel1" data-position="left" data-display="overlay" data-dismissible="true" data-theme="b" data-position-fixed="true" class="ui-panel ui-panel-position-left ui-panel-display-reveal ui-body-a ui-panel-animate ui-panel-closed">
	<ul data-role="listview" class="ui-listview panel-btnlist">
          <li id="lpanelclose" data-icon="delete" class="ui-first-child"><a href="#" data-rel="close" class="ui-btn ui-btn-icon-right ui-icon-delete">|</a></li>

          <!-- collapsible TECH -->
					<li data-role="collapsible" data-inset="true" data-mini="true" data-iconpos="right" data-collapsed="false" class="ui-collapsible ui-collapsible-themed-content ui-li-static ui-body-inherit feed-btnlist">


						<ul data-role="listview" class="ui-listview">
            <li ><a href="/topic/youtube/trending" class="ui-btn ui-btn-icon-right ui-icon-carat-r yttrendbtn">Trending</a></li>
					
							<li> <a href="/topic/tech" class="ui-btn ui-btn-icon-right ui-icon-carat-r feed-btn"				data-document-ids='[{"id":"channel_id_UCCjyq_K1Xwfg8Lndy7lKMpA"},{"id":"channel_id_UCOmcA3f_RrH6b9NmcNa4tdg"},{"id":"channel_id_UCSOpcUkE-is7u7c4AkLgqTw"},{"id":"channel_id_UCddiUEpeqJcYeBxX1IVBKvQ"},{"id":"user_marquesbrownlee"},{"id":"channel_id_UCR0AnNR7sViH3TWMJl5jyxw"},{"id":"channel_id_UCu0Uc1oNDF36jRY_sskl8bA"},{"id":"channel_id_UC-6OW5aJYBFM33zXQlBKPNA"}]' >Technology</a></li>

              <li> <a href="/topic/science" class="ui-btn ui-btn-icon-right ui-icon-carat-r feed-btn"				data-document-ids='[{"id":"channel_id_UCZYTClx2T1of7BRZ86-8fow"},{"id":"channel_id_UCzWQYUVCpZqtN93H8RR44Qw"},{"id":"channel_id_UCt_t6FwNsqr3WWoL6dFqG9w"},{"id":"channel_id_UCeiYXex_fwgYDonaTcSIk6w"},{"id":"channel_id_UCDXXnRDfuePViOGSE1szF2w"},{"id":"channel_id_UCtxJFU9DgUhfr2J2bveCHkQ"}]' >Science</a></li>


          		<li> <a href="/topic/gaming" class="ui-btn ui-btn-icon-right ui-icon-carat-r feed-btn"				data-document-ids='[{"id":"channel_id_UCbu2SsF-Or3Rsn3NxqODImw"},{"id":"playlist_id_PLiCvVJzBupKnXepW_381ILaaxaxK33vOv"},{"id":"channel_id_UCKy1dAqELo0zrOtPkf0eTMw"},{"id":"channel_id_UCedmzK8pHrU57erP9_oYNJg"}]' >Gaming</a></li>

              <li><a href="/topic/news" class="ui-btn ui-btn-icon-right ui-icon-carat-r feed-btn"				data-document-ids='[{"id":"channel_id_UC16niRr50-MSBwiO3YDb3RA"},{"id":"channel_id_UCNye-wNBqNL5ZzHSJj3l8Bg"},{"id":"channel_id_UCupvZG-5ko_eiXAupbDfxWw"},{"id":"channel_id_UCV3Nm3T-XAgVhKH9jT0ViRg"},{"id":"rssAudio_FlLP214NB0A9hngw"},{"id":"rssAudio_itn135067274"},{"id":"channel_id_UCBi2mrWuNuyYy4gbM6fU18Q"}]' >News</a></li>

			  <li><a href="/topic/comedy" class="ui-btn ui-btn-icon-right ui-icon-carat-r feed-btn"				data-document-ids='[{"id":"channel_id_UC8-Th83bH_thdKZDJCrn88g"},{"id":"channel_id_UC3XTzVzaHQEd30rQbuvCtTQ"},{"id":"channel_id_UCWXCrItCF6ZgXrdozUS-Idw"},{"id":"channel_id_UCMtFAi84ehTSYSE9XoHefig"},{"id":"channel_id_UCSAUGyc_xA8uYzaIVG6MESQ"},{"id":"channel_id_UCwWhs_6x42TyRM4Wstoq8HA"},{"id":"channel_id_UCUsN5ZwHx2kILm84-jPDeXw"},{"id":"channel_id_UCi7GJNg51C3jgmYTUwqoUXA"},{"id":"channel_id_UCqFzWxSCi39LnW1JKFR3efg"},{"id":"channel_id_UCVTyTA7-g9nopHeHbeuvpRA"},{"id":"channel_id_UCsDmESjqNPukDmVnuneLrqw"},{"id":"channel_id_UCGwu0nbY2wSkW8N-cghnLpA"},{"id":"channel_id_UCn1XB-jvmd9fXMzhiA6IR0w"},{"id":"channel_id_UC18vz5hUUqxbGvym9ghtX_w"},{"id":"channel_id_UCtw7q4SyOeoCwM1i_3x8lDg"}]' >Comedy</a></li>
			  <li><a href="/topic/recipes" class="ui-btn ui-btn-icon-right ui-icon-carat-r feed-btn"				data-document-ids='[{"id":"channel_id_UCbpMy0Fg74eXXkvxJrtEn3w"},{"id":"channel_id_UCJFp8uSYCjXOMnkUyb3CQ3Q"},{"id":"channel_id_UCD5WWnRed32y3xGwmrDhUiQ"},{"id":"channel_id_UCwZcpfUOuLH9UEXvFPHIAWQ"},{"id":"channel_id_UCpSgg_ECBj25s9moCDfSTsA"}]' >Recipes</a></li>
			  <li><a href="/topic/politics" class="ui-btn ui-btn-icon-right ui-icon-carat-r feed-btn"				data-document-ids='[{"id":"channel_id_UC-3jIAlnQmbbVMV6gR7K8aQ"},{"id":"channel_id_UC3M7l8ved_rYQ45AVzS0RGA"},{"id":"channel_id_UCzuqE7-t13O4NIDYJfakrhw"},{"id":"channel_id_UC1yBKRuGpC1tSM73A0ZjYjQ"},{"id":"channel_id_UCo9oQdIk1MfcnzypG3UnURA"},{"id":"channel_id_UCldfgbzNILYZA4dmDt4Cd6A"}]' >Politics</a></li>
			  <li><a href="/topic/review" class="ui-btn ui-btn-icon-right ui-icon-carat-r feed-btn"				data-document-ids='[{"id":"channel_id_UCY96oB1A0TiENISMIy_E2gg"},{"id":"channel_id_UCbLq9tsbo8peV22VxbDAfXA"},{"id":"channel_id_UCVYamHliCI9rw1tHR1xbkfw"},{"id":"channel_id_UCsTcErHg8oDvUnTzoqsYeNw"},{"id":"channel_id_UCgyqtNWZmIxTx3b6OxTSALw"},{"id":"channel_id_UCXuqSBlHAE6Xw-yeJA0Tunw"},{"id":"channel_id_UCSOpcUkE-is7u7c4AkLgqTw"},{"id":"channel_id_UCBJycsmduvYEL83R_U4JriQ"},{"id":"channel_id_UCOmcA3f_RrH6b9NmcNa4tdg"},{"id":"channel_id_UCddiUEpeqJcYeBxX1IVBKvQ"},{"id":"channel_id_UCsW36751Gy-EAbHQwe9WBNw"},{"id":"channel_id_UCO_vmeInQm5Z6dEZ6R5Kk0A"},{"id":"channel_id_UCTzLRZUgelatKZ4nyIKcAbg"},{"id":"channel_id_UCfXdejDvNviqilmJ9DvGuow"},{"id":"channel_id_UCvWWf-LYjaujE50iYai8WgQ"},{"id":"channel_id_UCW6J17hZ_Vgr6cQgd_kHt5A"},{"id":"channel_id_UCXGgrKt94gR6lmN4aN3mYTg"},{"id":"channel_id_UC9-EE_9NTDDW0lHad0YOlzQ"},{"id":"channel_id_UCB2527zGV3A0Km_quJiUaeQ"},{"id":"channel_id_UC8wXC0ZCfGt3HaVLy_fdTQw"}]' >Reviews</a></li>
			  <li><a href="/topic/entertainment" class="ui-btn ui-btn-icon-right ui-icon-carat-r feed-btn"				data-document-ids='[{"id":"channel_id_UC-lHJZR3Gqxm24_Vd_AJ5Yw"},{"id":"channel_id_UCTAgbu2l6_rBKdbTvEodEDw"},{"id":"channel_id_UCbu2SsF-Or3Rsn3NxqODImw"},{"id":"channel_id_UCedmzK8pHrU57erP9_oYNJg"},{"id":"channel_id_UCwmFOfFuvRPI112vR5DNnrA"},{"id":"channel_id_UCftwRNsjfRo08xYE31tkiyw"},{"id":"channel_id_UCCj956IF62FbT7Gouszaj9w"},{"id":"channel_id_UCKy1dAqELo0zrOtPkf0eTMw"},{"id":"channel_id_UCuCk_7b2_4uSr6y5hFmjuMQ"},{"id":"channel_id_UCYUQQgogVeQY8cMQamhHJcg"},{"id":"channel_id_UC6-ymYjG0SU0jUWnWh9ZzEQ"},{"id":"channel_id_UCUK0HBIBWgM2c4vsPhkYY4w"},{"id":"channel_id_UC1USVpNwJDn6EiNwqxqT80g"}]' >Entertainment</a></li>
			  <li><a href="/topic/edu" class="ui-btn ui-btn-icon-right ui-icon-carat-r feed-btn"				data-document-ids='[{"id":"channel_id_UCwmFOfFuvRPI112vR5DNnrA"},{"id":"channel_id_UC6nSFpj9HTCZ5t-N3Rm3-HA"},{"id":"channel_id_UC7IcJI8PUf5Z3zKxnZvTBog"},{"id":"channel_id_UCsXVk37bltHxD1rDPwtNM8Q"},{"id":"channel_id_UCoxcjq-8xIDTYp3uz647V5A"},{"id":"channel_id_UCUHW94eEFW7hkUMVaZz4eDg"},{"id":"channel_id_UCLXo7UDZvByw2ixzpQCufnA"},{"id":"channel_id_UCvQECJukTDE2i6aCoMnS-Vg"},{"id":"channel_id_UCzWQYUVCpZqtN93H8RR44Qw"},{"id":"channel_id_UCsooa4yRKGN_zEE8iknghZA"},{"id":"channel_id_UCX6b17PVsYBQ0ip5gyeme-Q"},{"id":"channel_id_UCAuUUnT6oDeKwE6v1NGQxug"},{"id":"channel_id_UCZYTClx2T1of7BRZ86-8fow"},{"id":"channel_id_UC9-y-6csu5WGm29I7JiwpnA"},{"id":"channel_id_UCbfYPyITQ-7l4upoX8nvctg"},{"id":"channel_id_UCKmkpoEqg1sOMGEiIysP8Tw"},{"id":"channel_id_UC4a-Gbdw7vOaccHmFo40b9g"},{"id":"channel_id_UCajXeitgFL-rb5-gXI-aG8Q"},{"id":"channel_id_UCBa659QWEk1AI4Tg--mrJ2A"},{"id":"channel_id_UCiTjCIT_9EXV1Wp1cY0zaUA"}]' >Edu</a></li>
			  <li><a href="/topic/podcast" class="ui-btn ui-btn-icon-right ui-icon-carat-r feed-btn"				data-document-ids='[{"id":"channel_id_UC-3jIAlnQmbbVMV6gR7K8aQ"},{"id":"channel_id_UCnxGkOGNMqQEUMvroOWps6Q"},{"id":"channel_id_UCsGdWQMkl4Yv4fLBQ3aCC1Q"},{"id":"channel_id_UC7DLT1zdSVGvnW11y4kqDng"},{"id":"channel_id_UCagoIYmo_gO1iVaCeeSikEg"},{"id":"channel_id_UCM4IHEg4jh7X_dJhzw_O4Gw"},{"id":"channel_id_UCzQUP1qoWDoEbmsQxvdjxgQ"},{"id":"channel_id_UCSAUGyc_xA8uYzaIVG6MESQ"},{"id":"channel_id_UCwY9B5_8QDGP8niZhBtTh8w"},{"id":"rssAudio_pdQkumhJkm3p50GJ"},{"id":"rssAudio_itn1355212895"},{"id":"channel_id_UCFP9Euhwi3GqbQmWS-M-0hA"},{"id":"rssAudio_K0A42RVF2MErl169"},{"id":"rssAudio_itn523121474"},{"id":"rssAudio_epBE4Of6xpPS26dT"},{"id":"rssAudio_0E9jaF0XBLHc7MYi"},{"id":"channel_id_UCfSgan80IQD_5U1t7UuwL3w"},{"id":"channel_id_UC1WHdBv9P5tYEGfy-btvYfA"},{"id":"channel_id_UCLxT-YVIAR4F3dRHped9Dkg"}]' >Podcast</a></li>
         
		 </ul>

					</li><!-- /collapsible -->


  </ul>

 <div >

</div>


		</div> <!-- #leftpanel1 -->


	</div>

	<script src=https://canvasonic.com/build/js/sly/sly.min.js></script>
	<script src=https://canvasonic.com/build/js/sly/sly.code.js></script>


	<!-- <script src=https://canvasonic.com/assets/js/syncnexus.js></script> -->
</body>


<script type='text/javascript'>//<![CDATA[

//config value

const basePath = "https://canvasonic.com";
const ytSearchUrl = basePath+"/yts";
const CSRF_TOKEN = $('meta[name="csrf-token"]').attr('content');

const userAgent={"mobileDevice":true,"deviceOS":false,"deviceCss":"desktop"};
var pageData={"pageTitle":"Canvasonic - YouTube Player","pageDec":"","hasPlayVidInfo":false,"playMediaType":null,"mediaContentType":"video.other","playTrackData":{"imgURI":""}};
var feedItemGroupObj = null; /// JSON.parse($feedDataObj); ///TODO: need to work on in userController.php -> processAcessPairKey() for get user feedObj data
var visitorData = {};
// var activeFilterObj;
// var beamModeOn = false;

////>------------XXXXXX
///> hub > deviceAppClient
var hub=[{

	"hubName":"RedNet",
	"hub.envo":[
		{
		"HubEnvoName":"Home",
		"selectedDevice":{"type":"station","typeID":0,"IPAddress":"","port":"", "deviceName":"raspbmc", "name":"","id":"","description":"","status":"","appID":"","appName":"","appScript":[]},
		"defaultDevice":{"type":"station","typeID":0,"IPAddress":"","port":"", "deviceName":"raspbmc", "cmd":"PC", "name":"PC","id":0,"description":"Nehalem-x64","status":"","appID":0,"appName":"Qualia Root Station","playMedia":function(targetEle){playMedia(targetEle);}, "playNext":function(targetEle){playMediaNext(targetEle)}, "voiceCmd":function(vTxtStr, vInType){voiceCmdForRootStation(vTxtStr, vInType);}, "appScript":[], "onSelectFn":function(){}, "indexVal":0},
		"devices":[
		 {"item":{"type":"webApp","typeID":0,"IPAddress":"","port":"", "deviceName":"This", "cmd":"This", "name":"This","id":0,"description":"This","status":"","appID":0,"appName":"Qualia Web App", "playPause":function(event){webPlayer.playPause();}, "playMedia":function(targetEle, aSwitchPlay=false, isQTrack=false, dragStartIndx=0){webMediaPlayerMasterObj.playMedia(targetEle,aSwitchPlay,isQTrack, dragStartIndx);}, "playNextAdd":function(itemData){$syncNexusObj.playNextAddToQPlaylist(itemData)}, "goToSecPlay":function(){webPlayer.seekToSec()}, "voiceCmd":function(vTxtStr, vInType){voicePlayRoute(vTxtStr, vInType);}, "tapPlayNext":function(){tapPlayNextWebPlayer();}, seekNextSec:function(){seekNextInWebPlayer();}, seekPrevSec:function(){seekPrevInWebPlayer();},  "screenSizeChange":function(){screenSizeChangeWebPlayer()}, "playSpeedUp" : function(){webPlayer.speedRate(0.25);}, "playSpeedDown" : function(){webPlayer.speedRate(-0.25);}, "appScript":[], "onSelectFn":function(){}, "indexVal":0}},
		],

		},
]
}];

var  $syncNexusObj  = { ///>> TODO:
    "id":0, "type":"station","typeID":0, "status":0,  "connctionName":"AppControl",
    "qPlaylistItemMoveEvent": function(itemData,dragStartIndx,indxDrop){if(indxDrop===0){activeDevice.playMedia(itemData, true, true, dragStartIndx);}}, ///playMediaWebPlayer(target, true, true, dragStartIndx);
		"qPlaylistItemRemoveEvent": function(itemData,itemIndx){},
		"playNextAddToQPlaylist" : function(itemData){playNextAddWebPlayer(itemData)},
  };


//app value
var skey='';

function isMobile() {
    var match = window.matchMedia || window.msMatchMedia;
    if(match) {
        var mq = match("(pointer:coarse)");
        return mq.matches;
    }
    return false;
}

function visitorActivityFn(activityTypeId){

let postPath="visitpost";
visitorData.activityType = activityTypeId;
let postData = visitorData; ///{activityType: 0, id: pageData.playTrackData.id, title: pageData.pageTitle, author: pageData.playTrackData.trackArtist, client: navigator.userAgent}

	$.ajax({
				url: "https://canvasonic.com/"+postPath, //"feed"
				type: 'post',
				contentType: 'application/x-www-form-urlencoded; charset=UTF-8',
				data: {payload: JSON.stringify(postData)}, //$('#app-form').serialize(),
				headers: {'X-CSRF-TOKEN': CSRF_TOKEN},
				success: function(data) {
					console.log('v!');
				},
				error: function(e) { }
			});

}

function updateSendVisitorActivity(activityTypeId, callbackFn){ 
	let notSameTrack = callbackFn();
	if(notSameTrack){
		visitorActivityFn(activityTypeId);
	}
}

function initilizeVisitorSession(){
	let timestamp = Date.now();
	if(typeof pageData.playTrackData.trackType !== 'undefined'){ ///(pageData.hasPlayVidInfo===true){ 
		
		visitorData = {activityType: 0, session_id: timestamp, uid: pageData.playTrackData.id, title: pageData.pageTitle, author: pageData.playTrackData.trackArtist, client: navigator.userAgent}

	}else {
		let visitItemID= 'home_'+timestamp;
		visitorData = {activityType: 0, session_id: timestamp, uid: visitItemID, title: pageData.pageTitle, author: "", client: navigator.userAgent}
	}

	visitorActivityFn(0);
}

$(document).ready(function() {

 $("body>[data-role='panel']").panel().enhanceWithin();

	if(isMobile()){userAgent.deviceCss='mobile'; userAgent.mobileDevice=true; if(navigator.userAgent.match(/iPhone|iPad|iPod/i)){userAgent.deviceOS='iOS'; if(navigator.userAgent.indexOf('iPad')!==-1){userAgent.deviceCss='tablet';} }else if(navigator.userAgent.match(/Android/i)){userAgent.deviceOS='Android'}}

	$('head').append("<link rel='stylesheet' href=https://canvasonic.com/assets/css/client/"+userAgent.deviceCss+".style.css type='text/css' />");

//> 0= clintApp offline; 1= add new user; 2= user re-visiting / refreshing
	//... initialSetPageProperty();
	//... initilizeVisitorSession();

//hang on event of form with id=app-form
	$('#app-form').submit(function(e) {

if( $('#search-mini').val() ) {

  	  // skey=	$('#search-mini').val();
			//console.log(ytSearchUrl+skey);
			//e.preventDefault();

			if(cmdSearch){

				inputKeywordSearchCmdFn();

			}else{ //> else its a action-cmd
				cmdActionInputRouteFn();
			}

      $('#search-mini').blur();

    }
$('#conPanel').hide();
  return false;

		});

/// actionCmdFilterArray; itemObjFilterArray; targetObjFilterArray
function cmdActionInputRouteFn(){ ///> its routes the command

	if(cmdTriggerOn){
		var lenghtCut= actionCmdName.length+2; //> ' addfollow '
		var inputTotalVal=$('#search-mini').val();//$.myinputText;///$
		var avtionVal= inputTotalVal.substring(lenghtCut);
		 $('#searchKey').val(avtionVal);

		actionCmdFilterArray[0].item.onExecute(inputTotalVal);

		// switch(actionCmdName){
		// 	case "post":
		// 			analyzeInputData(avtionVal);
		// 	break;
		// }

	}

}

 function inputKeywordSearchCmdFn(){ ///> this is search with input keyword Fn

		if(cmdTriggerOn){
			skey= $('#search-mini').val().substring(4); $('#searchKey').val(skey);
		}else{
			skey=	$('#search-mini').val().trim(); $('#searchKey').val(skey);
		}


		if(ytSearch && skey!==''){ 

			$('#nextPageTokenInput').val(''); // clearing previous nextPageToken to empty
			$('#ul_id').html('');
			pageNum=0;

			youtubeVidSearch(); //console.log('yt');

			$('.app-page.cardView-page').hide();
		}

	

 }

function youtubeVidSearch(){
					 $.ajax({
								url: ytSearchUrl,
								type: 'post',
								contentType: 'application/x-www-form-urlencoded; charset=UTF-8',
								dataType: 'json',
								data: $('#app-form').serialize(),
								success: function(data) {
									// searchDataStoreObj.initialIndex=0;
									// searchDataStoreObj.data = {}; ///data.results;
										searchDataStoreObj.initializeResult();
								 searchResult(data, 0);

								},
					error: function(e) {
						console.log(e.responseText);
					}
				});
}

function customSnapScrollFn(event){
	event.preventDefault(); 
		if (event.originalEvent.wheelDelta >= 0) {
		$.scrollify.previous();
		}
		else {
			$.scrollify.next();
		}
		//console.log("custom-Scroll-Event!!");
}

///> NOTE: this is event is required for scrollify.js library implementation (if not using the library remove it)
$('#rootContainer').bind('mousewheel', function(event) {
	customSnapScrollFn(event);
});

$('#footer').bind('mousewheel', function(event) {
	customSnapScrollFn(event);
});

$('.panel-wrapper').bind('mousewheel', function(event) {
	customSnapScrollFn(event);
});

$('.ui-header').bind('mousewheel', function(event) {
	if($('#conPanel').is(':visible')===false)
	{
		customSnapScrollFn(event);
	}
});



$( "body>[data-role='panel']" ).panel();
$( "div#leftpanel1" ).on( "panelopen", function( event, ui ) {$("#panelLBtn").hide();} );
$( "div#leftpanel1" ).on( "panelclose", function( event, ui ) {$("#panelLBtn").show();} );

/// loadLinkDeviceList();
initialActiveDeviceSelection();

 ///> selecting activeDevice & defaultDevice
 $('#select-choice-0').on('change', function () {

				var indx=$(this).prop('selectedIndex');
				//console.log(indx);
				selectActiveDevice(indx);

		});

	$('#connectForm').submit(function(e) {

	var conKey=	$('#connectForm #un').val();

	$.post( "https://canvasonic.com/app", $('#connectForm').serialize()).done(function(data) { if(data=="true"){ window.location.href = basePath+'/app';};	}); //

});

		$('.ui-controlgroup-controls input[type=checkbox]').on('click', function () {
			var sibLabel=$(this).siblings('label');
			var selectedVal = $(sibLabel).text();
			var actionVal=false;
		if ($(sibLabel).hasClass( "ui-checkbox-on" )) //($(this).is(":checked"))
		{

						 $(sibLabel).removeClass('ui-checkbox-on');
						 $(sibLabel).addClass('ui-checkbox-off');
			//console.log('un-checked');
		}else{
			actionVal=true;
						 $(sibLabel).removeClass('ui-checkbox-off');
						 $(sibLabel).addClass('ui-checkbox-on');
			//console.log('checked');
		}
	 if(selectedVal=="YouTube"){ytSearch=actionVal;}
});


		$(document).on('click', '#app-form .ui-input-clear', function () {
			resetToDefaultSearchOption();
		});

		////>>>> Ctrl = will show number lable; Ctrl + Number = will play; Ctrl + Number = will Add to Queue,
				// $('.ui-panel-wrapper').bind('keydown', function(e) {
					$(document).keydown(function(e) {
						// You may replace `c` with whatever key you want
						if ( e.ctrlKey ) { //&& ( String.fromCharCode(e.which).toLowerCase() === 'c')

if($("#search-mini").is(':focus')===false){
						 showNumersOnCtrlPress(true);
						 ctrlIsDown=true;

						var isShiftTrue=e.shiftKey;
						//console.log(e.which);
						 if (	e.which >= 48 && e.which	<= 57	){
							 	e.preventDefault();
								 console.log( e.which );
								 numKeyPressed=String.fromCharCode(e.which);
								 crtlAndNumbKeyPressed(isShiftTrue);

									//if(isShiftTrue){console.log( "You pressed CTRL + SHIFT" );}else{console.log( "You pressed CTRL" );}
						}
					} ///if focus
					else{
						if (	e.which >= 48 && e.which	<= 57	){
							 e.preventDefault();
								//console.log( e.which );
								var numKey=parseInt(String.fromCharCode(e.which))-1;
								selectFilterCmdWithIndex(numKey);
							}
					}
				}else if( e.keyCode == 32 && ($("#search-mini").is(':focus')===false)){
					e.preventDefault();
					$('.conPlayBtn').trigger("mousedown");
					//console.log("SPACE!! - KEY");
				}

				});

				// $('.ui-panel-wrapper').bind('keyup', function(e) {
		$(document).keyup(function(e) {
						if ( e.keyCode == 17 ) {
						 // console.log( "You up CTRL" );
						 showNumersOnCtrlPress(false);
						 ctrlIsDown=false;
						 numKeyPressed=null;
						}
				});

		$('#search-mini').keyup(function (e) {
						var code = e.which;
						switch (code) {
							default:
								autoSuggestFn($('#search-mini').val());
							break;
						}
				});

	if(userAgent.mobileDevice==false){
				$.getScript('/build/js/voice/voiceScript_DesktopChrome.js');
				$.getScript('/build/js/keyboard/keyboardScript_Desktop.js');
				//$.getScript('/build/js/devicescript/desktop.js');
	}else{

		if(userAgent.deviceOS=="iOS"){
				$.getScript('/build/js/voice/voiceScript_iOS.js');
				$.getScript('/build/js/keyboard/keyboardScript_iOS.js');
				$.getScript('/build/js/devicescript/ios.js');
		}else{
				$.getScript('/build/js/voice/voiceScript_Android.js');
				$.getScript('/build/js/keyboard/keyboardScript_Android.js');
		}
	}

	Array.prototype.move = function(from,to){
	  this.splice(to,0,this.splice(from,1)[0]);
	  return this;
	};

	(function( func ) {
    $.fn.addClass = function() { // replace the existing function on $.fn
        func.apply( this, arguments ); // invoke the original function
        this.trigger('classChanged'); // trigger the custom event
        return this; // retain jQuery chainability
    }
})($.fn.addClass); // pass the original function as an argument

(function( func ) {
    $.fn.removeClass = function() {
        func.apply( this, arguments );
        this.trigger('classChanged');
        return this;
    }
})($.fn.removeClass);


$("div.ui-header").on('classChanged', function(){
	//console.log("changeClass!!!")
	if($(this).hasClass('ui-fixed-hidden')){
		if(toolBarVisible===true){toolBarVisible=false;toolBarHeight=0;	//console.log("hidden !! - changeClass!!!");
			$.scrollify.setOptions({offset:-25}); ///-18 //-25		
			$('#conPanel').hide();	
		}
		
	}else if(toolBarVisible===false && $("#swipebox-overlay").hasClass("miniPlayScreen")){
			toolBarVisible=true;toolBarHeight=79;	//console.log("showing !! - changeClass!!!");
			$.scrollify.setOptions({offset:-(23+toolBarHeight)}); ///14 //-23
		
				$("#search-mini").focus();
			
			//$('#conPanel').hide();
		
	}
});

///>>> Scroll Active Define
///>>> Scroll Active Define
 activePage = $.mobile.pageContainer.pagecontainer('getActivePage');
 screenHeight = $.mobile.getScreenHeight();
 headerHeight = $('.ui-header', activePage).outerHeight() - 350;
 searchBoxHeight = $('#app-form', activePage).outerHeight() - 350;


////>>>>>> END OF Doc-Ready
////>>>>>> END OF Doc-Ready
});  ////> END OF Doc-Ready
////>>>>>> END OF Doc-Ready
////>>>>>> END OF Doc-Ready



var selectedItem;
var ctrlIsDown=false;

var myinputText ="";
var lastVal = "";
var panelPinned=false;

var toolBarVisible=true;
var toolBarHeight=79;

Storage.prototype.setObject = function(key, value) {
		this.setItem(key, JSON.stringify(value));
}

Storage.prototype.getObject = function(key) {
		return JSON.parse(this.getItem(key));
}

if(location.pathname === "/" || location.pathname === "/app"){ ///(location.href.includes("://canvasonic.com/topic/")===false){
 var viewItemDataStoreObj={addMoreFn: function(){}};
}else{
 
}

var feedDataStoreObj={data:[],initialIndex:0, page:0, postData:{}, dataLength:0, initializeResult: function(data){this.data=data; this.initialIndex=0; $('#ul_id').html(''); lastEndScrolled=0; this.page=0; this.dataLength=this.data.length; },  addMoreFn : function(){addMoreFeedItem();}, loadNewPage: function(dataN){this.data = this.data.concat(dataN); this.dataLength=this.data.length;}};
var searchDataStoreObj={data:[],initialIndex:0, initializeResult:function(){this.data = {}; this.initialIndex=0; lastEndScrolled=0;}, addMoreFn : function(){if(ytSearch===true ){addMore();}else if(ytSearch===false ){} }};
var cmdSearchDataStoreObj={data:[],initialIndex:0,  addMoreFn : function(){}};

//////



//////

$(window).load(function(){

	initialSetPageProperty();
	///---
	///---
	///---initialPageLoadCallbackFn();
	///---
	initilizeVisitorSession();

});

///---var initialPageLoadCallbackFn=function(){};

function initialSetPageProperty(){
					/// var appPath = "canvasonic.com";
					if(location.pathname === "/" || location.pathname === "/app") /// (location.href.includes("://canvasonic.com/topic/")===false){
					{
						$(".feed-btnlist .ui-btn.yttrendbtn").trigger("tap");
						if(userAgent.mobileDevice!==true){ $( "div#leftpanel1" ).panel( "open"); }///>> show menu

					}else{
						
						if(location.pathname.startsWith("/watch") ===true || location.pathname.startsWith("/podcast") ===true || location.pathname.startsWith("/topic") ===true){
					
							if( (pageData.playMediaType !== null) && (typeof pageData.playMediaType !== 'undefined')){ ///>> has a media Track to play on page Load
								
								let track_id = pageData.playTrackData.id;
								pageData.playTrackData.trackTitle = unescape(pageData.playTrackData.trackTitle);
								pageData.playTrackData.trackArtist = unescape(pageData.playTrackData.trackArtist);

								hideSlyPanel();
								$( ".ui-header" ).toolbar( "hide" );
								
								if(track_id.length ===11 && pageData.playMediaType ===0){

									let playVidFn = function(){
										let itemData = pageData.playTrackData;
										activeDevice.playMedia(itemData);
									}
									
									// console.log("getYTVidDataFromOEmbedAndPlay or playVidFn: "+ pageData.hasPlayVidInfo);
									if(pageData.hasPlayVidInfo===false){  
										 getYTVidDataFromOEmbedAndPlay(track_id, playVidFn);  
									}else{
										playVidFn(); 
									}

								} else if(pageData.playTrackData.trackType==="rssAudio"){
									//console.log("Play rssAudio!!");
									 activeDevice.playMedia(pageData.playTrackData);
								}else{
									//pageData.playTrackData = itemEventToObject(0, viewItemDataStoreObj);
									 startPlayingChannelVid();
								}
							}else{
								//pageData.playTrackData = itemEventToObject(0, viewItemDataStoreObj);
								 startPlayingChannelVid();
							}

						}else if(userAgent.mobileDevice!==true){
							$( "div#leftpanel1" ).panel( "open"); ///>> show menu
						}

						///>>
						///.. itemResulLodadMakeScrollReady(0);
					}
}

function startPlayingChannelVid(){

						pageData.playTrackData = itemEventToObject(0, viewItemDataStoreObj);
						let itemData = pageData.playTrackData; ///itemEventToObject(indx, viewItemDataStoreObj);
						activeDevice.playMedia(itemData);

						/// Adding Next Two Vids		
						if(itemData.trackType.includes('youtube')){
								addVidToQPlayByMultiplLoop(0, 3);
						}	
}

function addVidToQPlayByMultiplLoop(startIndex, addCount){
	startIndex=startIndex+addCount;
	for( i=addCount;i>0;i--){
		let itemData =itemEventToObject(startIndex, viewItemDataStoreObj);
		let duplicateEntry = checkInQPlaylistForDuplicate(itemData.id);
		if(duplicateEntry===false){
			activeDevice.playNextAdd(itemData);
		}
		startIndex--;
	}
}

function checkInQPlaylistForDuplicate(ytVidID){

	return qPlaylistObj.item.some(function (item) {
      /// console.log("item.id : "+item.id +" --------- ytVidID : "+ytVidID);
						return item.id===ytVidID;
        });
}

function getYTVidDataFromOEmbedAndPlay(vidID, callbackFn){

	var ytUrl = 'https://www.youtube.com/watch?v=' + vidID;

	$.getJSON('https://noembed.com/embed',
			{format: 'json', url: ytUrl},
				function (data) {
				var vidData = data; // JSON.parse(data);
				  console.log(vidData);
				trackData={};
						trackData.webUID = ytUrl; // "https://www.youtube.com/watch?v=".vidID;
            trackData.imgURI = "https://i.ytimg.com/vi/"+vidID+"/mqdefault.jpg"; 
            trackData.trackType = "youtubeAddOrPlay";
            trackData.imgWidth = 178;
						trackData.trackTitle=vidData.title;  trackData.trackArtist =vidData.author_name; trackData.playlistUID=""; trackData.logoURL="";
						trackData.id=0; 	trackData.startTime=0; trackData.trackDuration=0;

				pageData.playTrackData=trackData;
				document.title = vidData.title+' - Canvasonic';
				callbackFn();
			});

}

///>>> Scroll Active
///>>> Scroll Active
var lastEndScrolled=1;

var activePage ;
var screenHeight;
var headerHeight;
var searchBoxHeight;
var scrollEnd =0;

/* scroll event */
// $(document).on('scroll', function (e) {


// //  var scrolled = $(window).scrollTop();
// //             if ( scrolled >= scrollEnd && lastEndScrolled!==scrollEnd) { 

// //                 lastEndScrolled=scrollEnd;
// //                 viewItemDataStoreObj.addMoreFn();     
// //             }

// });

			
function adjustPageInfinityLoad(){
	var	contentHeight = $('.ui-content', activePage).outerHeight();
	scrollEnd = contentHeight - screenHeight	+ searchBoxHeight + headerHeight;
	//console.log("scrollEnd: "+ scrollEnd);
}

//var searchResultItemCount=0;

function searchResult(data, initialIndex) {

 var nextPageTokenVal=data.info.nextPageToken;

 if(nextPageTokenVal !== $('#nextPageTokenInput').val()){

	$('#nextPageTokenInput').val(nextPageTokenVal);
 		//console.log(nextPageTokenVal);

		 $.each(data.results, function(index, item) {

		 //console.log(item.snippet.title);
		 var vTitle = item.snippet.title; //data[index].snippet.title;
		 var vID =	item.id.videoId; //data[index].id.videoId;
			 var vidURL = 'https://www.youtube.com/watch?v='+vID;
			// var imgURL = 'http://i.ytimg.com/vi/' + vID + '/hqdefault.jpg';

			let objIndex = initialIndex+index;// +feedDataStoreObj.initialIndex

			item.id=objIndex;
			item.trackType= "youtubeAddOrPlay";//itemSubType;
			item.webUID=vidURL;
			item.playlistUID="";

			item.title=vTitle;
			item.author = {name:""};

			item.imgURL=""; //imgURL;
			item.logoURL=""; //itemLogoURL;
			searchDataStoreObj.data[objIndex] = item;

			var viewSection = "";
			var viewSnapEleIndx=objIndex;
			if(viewSnapEleIndx % 2 == 0 && viewSnapEleIndx >0) {viewSection="viewSection"; }

		 $('.listView-page #ul_id').append('<li class=\''+viewSection+'\'><a class=\'fname\' data-index=\'' + objIndex + '\' href=\''+vidURL+'\'> <img	class=\'ui-li-thumb feedItemThumb ytThumbImg \' src=\'https://i.ytimg.com/vi/' + vID + '/hqdefault.jpg\' data-index=\'' + objIndex + '\'  ></img><h2	>' + vTitle + '</h2><p class="ui-li-aside"></p></a><a	data-index=\'' + objIndex + '\' href=\'#\' data-icon=\'carat-r\' class=\'carat-r\' width=\'60px\' data-position-to=\'window\' data-transition=\'pop\'>Play</a></li>');


	});

	$('.listView-page #ul_id').listview('refresh');
	adjustPageInfinityLoad();
	//var initialIndex =  searchDataStoreObj.initialIndex;
	searchDataStoreObj.initialIndex = Object.keys(searchDataStoreObj.data).length; ///searchDataStoreObj.data.length;
	itemResulLodadMakeScrollReady(initialIndex);
	viewItemDataStoreObj = searchDataStoreObj;

}

}

/* load more fucntion */
function addMore() {
	
	$.myinputText =	$('#search-mini').val().trim(); 
	if($.myinputText !==''){
//	setTimeout(function (e) {
	 //get the action-url of the form

			//do your own request an handle the results
					 $.ajax({
							url: ytSearchUrl, //> ytSearchUrl+skey
							type: 'post',
						 contentType: 'application/x-www-form-urlencoded; charset=UTF-8',
							dataType: 'json',
							data: $('#app-form').serialize(),
							success: function(data) {
								//searchDataStoreObj.data = data.results;
								 searchResult(data, searchDataStoreObj.initialIndex);
								
							 
							},
				error: function(e) {
					console.log(e.responseText);
				}
			});

//	}, 100);
	}
}

function trendResultList(data) {
$('#ul_id').html('');
		$.each(data, function(index, item) {

		//console.log(item);
		var vTitle = item.snippet.title; //data[index].snippet.title;
		var vID =	item.id; //data[index].id.videoId;
		var vidURL = 'https://www.youtube.com/watch?v='+vID;
		var vDescription = item.snippet.description.substring(0, 180)+" ...";
		//var filterTitle = encodeURIComponent(vTitle).replace(/'/g, "%27");//.replace(/\'/g,'^*~~').replace(/""/g,'^~~').replace(',','^^~');
		
		var imgURL = 'https://i.ytimg.com/vi/' + vID + '/hqdefault.jpg';

		let authorName=item.snippet.channelTitle;
		let itemLogoURL="";

			item.id=index;
			item.trackType= "youtubeAddOrPlay";//itemSubType;
			item.webUID=vidURL;
			item.playlistUID="";

			item.title=vTitle;
			item.author = {name:""};

			item.imgURL=imgURL;
			item.logoURL=""; //itemLogoURL;
			searchDataStoreObj.data[index] = item;

		var viewSection = "";
		if( index % 2 == 0 && index>0) {viewSection="viewSection"; }

		 $('.listView-page #ul_id').append('<li class=\''+viewSection+'\'><a class=\'fname\' href=\''+vidURL+'\' data-index=\'' + index + '\' onclick="return false;"> <img	class=\'ui-li-thumb feedItemThumb ytThumbImg \' src=\'https://i.ytimg.com/vi/' + vID + '/hqdefault.jpg\' data-index=\'' + index +'\' alt=\''+vTitle+ '\' ></img><h2 ><span id="itemTitle" data-index=\'' + index + '\' onclick="tapToPlay(event); return false;" >' + vTitle + '</span><span id="itemDescription">'+ vDescription +'</span><span id="itemImgBlock">►</span><span id="itemInfoBar">'+ authorName+'</span></h2><p class="ui-li-aside"></p></a><a data-index=\'' + index + '\' href=\'#\' data-icon=\'carat-r\' class=\'carat-r\' width=\'60px\' data-position-to=\'window\' data-transition=\'pop\'>Play</a></li>');
			
		/// var elementHTML= '<li class=\''+viewSection+'\'><a class=\'fname\' href=\''+itemURL+'\' data-index=\'' + objIndex + '\' onclick="return false;"> <img class=\'ui-li-thumb feedItemThumb ' + itemThumbType + '\' src=\'' + imgURL + '\' data-index=\'' + objIndex + '\' onload=\'javascript:imgLoadedFeed(this);\' ></img><h2	><span id="itemTitle">' + itemTitle +'</span><span id="itemDescription">'+ itemDesc+'</span><span id="itemImgBlock"><img src="'+ itemLogoURL+'"/></span><span id="itemInfoBar">'+ authorName+'</span></h2><p class="ui-li-aside"></p></a><a	href=\'#\' data-index=\'' + objIndex + '\' data-icon=\''+listIconClass+'\' class=\''+listIconClass+'\' width=\'60px\' data-position-to=\'window\' data-transition=\'pop\'>Play</a></li>';
	

		});

	$('.listView-page #ul_id').listview('refresh');
	adjustPageInfinityLoad();
	itemResulLodadMakeScrollReady(0);
	viewItemDataStoreObj = searchDataStoreObj;
	
}

var pageNum=0;

function getYTIDFromURL(YTUrl){
 var myString =  decodeURIComponent(YTUrl);
 var myRegexp = /(?:watch\?v=|watch\?.+&v=|embed\/|v\/|.+\?v=)?([^&=\n%\?]{11})/g;
 var match = myRegexp.exec(myString);
 return match[1];
}

function localMediaLibraryUIResult(data) {

$('.app-page.listView-page').hide();
$('.app-page.cardView-page').show();

			$.each(data, function(index, item) {

			 var entityName = item.entityName; //data[index].snippet.title;
			 var itemType =	item.itemType; //data[index].id.videoId;
			 var entityUID = encodeURIComponent(item.entityUID).replace(/'/g, "%27");
			 var apiIDs = item.apiIDs;
			 var itemGenre = item.genre;
			 var filterTitle = encodeURIComponent(entityName).replace(/'/g, "%27");// .replace(/\'/g,'^*~~').replace(/""/g,'^~~').replace(',','^^~');
 		 	var coverArtID = item.coverArtID;
			var imgPoster="";
				if(coverArtID!=null){
							coverArtID = coverArtID.split(',');
							var bseImgURL = "https://image.tmdb.org/t/p/w500";
						  imgPoster=bseImgURL+coverArtID[0].trim(); var imageBackground =	bseImgURL+coverArtID[1].trim(); //imgPoster = imageBackground;
				}
				var imgStyle='';
				 $('.cardView-page #ul_id').append('<li><a class=\'fname\' clickmick=\''+index+','+itemType+','+entityUID+',,'+filterTitle+',,\' href=\''+entityUID+'\'> <img '+ imgStyle + 'class=\'ui-li-thumb\' src=\'' + imgPoster + '\' ></img><h2	>' + entityName + '</h2><p class="ui-li-aside"></p></a></li>');

				$('.cardView-page #ul_id').listview('refresh');

			});
		//	pageNum++;
}


	function getmediaLibraryItems(event){
		$('#ul_id').html('');
		var targetItemVal = $(this).attr("data-id");
		//var postData =$(event.target).data('documentIds');
		//console.log(targetItemVal);
		mediaLibraryFetchAjax(targetItemVal);
		event.preventDefault();
	}

	function slyPanelViewShow(){	if(tapOnHold===false){if($('.slyWrap').is(':visible')===true){$('.slyWrap').fadeOut(); panelPinned=false; progBarOpaDown();}else{$('.slyWrap').fadeIn(); $slyFrameObj.reload();panelPinned=true; progBarOpaUp();} }else{tapOnHold=false;}}
	function hideSlyPanel(){
				//console.log(' mouseout!! from : .panel-wrapper');
				if (panelPinned===false){
				// console.log("panelPinned : "+ panelPinned);
				  if($('.slyWrap').is(':visible')===true){  $('.slyWrap').fadeOut();} //console.log("slyWrap : IS visible");
				  progBarOpaDown();
				}
				
 					//else{$('.slyWrap').fadeIn(); $slyFrameObj.reload();}
		 }
		 function progBarOpaUp(){$('.show_sliderbar .ui-slider .ui-slider-track').fadeTo( "fast", 0.4);} ///.css('opacity', '0.4');
		 function progBarOpaDown(){$('.show_sliderbar .ui-slider .ui-slider-track').fadeTo( "fast", 0.2);} ///.css('opacity', '0.2');
//////

 ///> $('body').on('taphold', '.fname', tapHandler );
 $('body').on('tap', '.carat-r', tapPlayNextAdd ); //'>' btn : 'taphold' / 'tap'
 $('body').on('mousedown', '.conPlayBtn', function(e){playPauseFn(e);}); ///tapPlayPause

 $('body').on('tap', '.conNextBtn',	tapSeekNext);
 $('body').on('tap', '.conPrevBtn',	tapSeekPrev);
 $('body').on('taphold', '.conNextBtn', tapPlayTheNextOne );
 $('body').on('taphold', '.conPrevBtn', tapPlayThePrevOne );

 $('body').on('tap', '#search-mini', searchBoxSelected );
 $('body').on('tap', '.fname', tapUPHandler );
// $('body').on('tap', '.switchPlayBtn', tapSwitchPlay ); ///> not in use
 $('body').on('tap', '.syncSlyQListBtn', function(){} );
//  $('body').on('tap', '.nextPlayBtn', btnPlayNext );
 $('body').on('tap', '.quickPlayBtn', slyPanelViewShow ); ///>btnQuickPlay
 $('body').on('tap', '.screenSizeBtn', btnScreenSize);
 $('body').on('tap', '.showSliderConBtn', slyPanelViewShow);
 $('body').on('taphold', '.showSliderConBtn', showSliderConFn);
 $('body').on('slidestart', "#show_sliderbar #slider-mini", sliderTapStartEventFn);
 $('body').on('slidestop', "#show_sliderbar #slider-mini", sliderTapSlideEventEndFn);
 $('body').on('change', "#show_sliderbar #slider-mini", sliderChangeEventFn);

 $('body').on('tap', '.ui-li-thumb', function(event){ tapToPlay(event); return false; });
 
//> $('body').on('tap', 'li.cmdListItem',	selectCmdFromList);
 $('body').on('tap', '.cmd-li-thumb', tapToCmd );

 $('body').on('tap', '#itemInfoBar', goAtItem );

 $('body').on('dragover', '.slyWrap', function(event){  event.preventDefault();   event.stopPropagation();});
 $('body').on('dragleave', '.slyWrap', function(event){ event.preventDefault();   event.stopPropagation();});
 $('body').on('drop', '.slyWrap', function(event){ event.preventDefault();   event.stopPropagation(); var data = event.originalEvent.dataTransfer.getData("text");  }  );

 $('body').on('mouseenter', '.quickButtons, .nowPlayingTrackPrv', hideSlyPanel); //>> mouseover
 //$('body').on('mouseenter', '.panel-wrapper', progBarOpaUp); //>> mouseover

 $('body').on( "error", "img.feedItemThumb", function(){console.log('Img ERROR!!');} );
 $('body').on( "error", "span.itemImgBlock img", function(){console.log('Img ERROR 2!!');} );
function handleError() {
    this.src = ResolveUrl("~/images/tree-item.png");
}

 var ytID;
var playMediaAction;

function itemEventToObject(index, dataSourceObj){
	let itemObj = dataSourceObj.data[index];

	 let title = itemObj.title; /// (Array.isArray(itemObj.title) ? itemObj.title[0] : itemObj.title );
	 let autherName = itemObj.author.name; /// (Array.isArray(itemObj.author.name) ? itemObj.author.name[0] : itemObj.author.name );

	let itemData ={"id":itemObj.id, "trackType":itemObj.trackType,"webUID": itemObj.webUID, "playlistUID":itemObj.playlistUID, "trackTitle":title, "trackArtist":autherName, "imgURI":itemObj.imgURL, "imgWidth":'', "logoURL": itemObj.logoURL, "startTime":0, "trackDuration":0};

	return itemData;		
}

	function tapToCmd( event ){

		playMediaAction = "playVid";
		//console.log("tapToCMD");
		let indx= $(event.target).data('index');
		let itemData =itemEventToObject(indx, cmdSearchDataStoreObj);
		activeDevice.playMedia(itemData);
		$('#search-mini').blur();
		$('#conPanel').hide();

		event.preventDefault();
		return false;
	}

	function tapHandler(event){

			playMediaAction = "playVid";
				
			activeDevice.playMedia(this);
			//console.log("taphold");
			event.preventDefault();
			return false;
	}

function tapToPlay( event ){

	playMediaAction = "playVid";

	//console.log("tapToPlay");			
	let indx= $(event.target).data('index'); ///>>> $('a.fname').index(this); 
	
	let ele = viewItemDataStoreObj.data[indx];
	//console.log(ele);

	if(ele.elementSubType !== "rssWeb"){

		let itemData =itemEventToObject(indx, viewItemDataStoreObj);
		visitorData.actionOn ="tapToPlay - itemTitle";

		activeDevice.playMedia(itemData);

	}else if(ele.elementSubType==="rssWeb"){

		 viewOnReader(ele); 

	}
	event.preventDefault();
	return false;
}

function viewOnReader(ele){

let postPath="getampurl";
let postData = {webUID: ele.author.link, itemType: ele.elementType, eleUID: ele.id}
	$.ajax({
				url: "https://canvasonic.com/"+postPath, //"feed"
				type: 'post',
				contentType: 'application/x-www-form-urlencoded; charset=UTF-8',
				data: {_token: CSRF_TOKEN,  payload: JSON.stringify(postData)}, //$('#app-form').serialize(),
				headers: {'X-CSRF-TOKEN': CSRF_TOKEN},
				success: function(data) {
					let iURL = data; /// iFrameURL
					//console.log(iURL);
					if( $("#viewer").attr('src') !== iURL ){ 
						loadIframe(iURL);
					}
					if ( $("#popupReader").parent().hasClass('ui-popup-hidden')) { $( "#popupReader" ).popup( "open" ); }

				},
	error: function(e) {
		console.log(e.responseText);
					}
				});

}

function loadIframe(url) {
	let iframeName="viewer";
    var $iframe = $('#' + iframeName);
    if ( $iframe.length ) {
        $iframe.attr('src',url);  ///> $("#viewer").prop("src", "");
        return false;
    }
    return true;
}

		function tapPlayNextAdd(event){ // add to play next in queue list
	 
				let indx= $(event.target).data('index');
				//console.log(indx);
				let itemData =itemEventToObject(indx, viewItemDataStoreObj);
				activeDevice.playNextAdd(itemData);
				event.preventDefault();

				return false;
	}



	var playerWebTrackURI='';
	function mediaIsPlayingEvent(trackDuration){
			// console.log('playing on web player!! playerWebTrackURI='+playerWebTrackURI);
			 if(playerWebTrackURI!==webMediaPlayerMasterObj.playTrack.webUID){

			webMediaPlayerMasterObj.playTrack.trackDuration = qPlaylistObj.item[0].trackDuration = trackDuration;
			
			 var trackData= webMediaPlayerMasterObj.playTrack; // // var nTrk=qPlaylistObj.item[0]; /// qPlaylistObj.item[0]; //makeWebPlayerPlaybackFromQPlaylist(nTrk,trackDuration);
			 newTrackPlyingFn("playing", trackData);
			 playerWebTrackURI=qPlaylistObj.item[0].webUID;
			 
			 }else{
				 //updateProgSlider=true;
				 masterPlayerUI.play();
			 }
			 ///NOTE: this Function will be called after 'playMediaWebPlayer' so  qPlaylistObj.item[0] data is valid as a now playing track.
		 }

	function addNowPlayEventObj(itemData, aSwitchPlay=false, isQTrack=false, dragStartIndx=0, playTimestamp)
		 {
			
			 let clickmickEventObj = {};
			
			 ///> in 'playMediaWebPlayer' function > these value are loded in 'nowPlayingTrack' (nTrk)
			 clickmickEventObj.isQueueTrack=isQTrack; //"False";
			 clickmickEventObj.playWasASwitchPlay=aSwitchPlay; //"False";
			 clickmickEventObj.switchPlayIndx=dragStartIndx; //"False";
			 clickmickEventObj.playTimestamp=playTimestamp;
			 itemData.clickmickEventObj= clickmickEventObj;
			 return itemData;
		 }


///>> 'webPlayer' object webPlayer in currently in control (built by 'webMediaPlayerMasterObj' from 'webPlayerList' array of player obj)
var webPlayer = {};
///>> 'webMediaPlayerMasterObj' is a Object to build and control All WebbApp Media Player [YouTube, HTML5 Player, SoundCloud etc.]
var webMediaPlayerMasterObj = {
playerIndx:0, playerStatus : 0, playTrack:{},
playMedia:function(itemData, aSwitchPlay=false, isQTrack=false, dragStartIndx=0){ //targetEle, aSwitchPlay=false, isQTrack=false, dragStartIndx=0
	
    if(playerWebTrackURI!==itemData.webUID){

	var pIndx = webMediaPlayerMasterObj.playerIndx;
		var trackType = itemData.trackType;
	///>> checking webPlayer Type for the new Media Track [YouTube, SoundCloud, HTML5 Video/Audio], if needed change player in webPlayer{} obj
		if(trackType.includes('youtube')){pIndx=0;}
		else if(trackType.includes('rssAudio')){pIndx=1;}
		else if(trackType.includes('rssVideo')){pIndx=2;};

		//console.log("TrackType: "+trackType+ " | PlayerID: "+pIndx);
		if(pIndx !== webPlayer.id){ ///> switching wenPlayer module
			webPlayer.close(pIndx);
			webPlayer =	webMediaPlayerMasterObj.webPlayerList[pIndx];
			webMediaPlayerMasterObj.playrIndx = pIndx;
		}
		
		let nowTime=Date.now();
		this.playTrack =  addNowPlayEventObj(itemData, aSwitchPlay, isQTrack, dragStartIndx, nowTime);
	///>> passing media data & playing in selected type on webPlayer
			webPlayer.playMedia(this.playTrack, aSwitchPlay, isQTrack, dragStartIndx); ///> 'dragStartIndx' ==s 'switchPlayInt'

        		 if(isQTrack===false){ 
			
					 insertASlyItem(this.playTrack, 0);
					  makeLastPlayedAQueueTrack(1);
					}
	
						 qPlaylistObj.lastUpdateTime=nowTime;

						 localStorage.setObject('qPlaylsitJSON', qPlaylistObj);

				}else{webPlayer.playPause();}
},
webPlayerList : [
	{
		id:0, name:"youtube", 
		playPause:function(event){playerWebPlayPause();},
		playMedia : function(itemDataObj, aSwitchPlay, isQTrack, dragStartIndx){playMediaWebPlayer(itemDataObj, aSwitchPlay, isQTrack, dragStartIndx);},
		seekToSec : function(){playWebPlayerFromSec();},
		jumpToSec : function(sec){ jumpToSecWebPlayer(sec); },
		speedRate : function(rate){ playerSpeedRateControl(rate); },
		close : function(playingMediaID){ if(typeof(player.pauseVideo) === "function"){player.pauseVideo(); $.swipebox.close();} } /// typeof(player.pauseVideo) !== 'undefined' ///if(playingMediaID===1){ $.swipebox.hide();}else{ $('#swipebox-overlay').remove();} }; }
	},
	{
		id:1, name:"webAudioPlayer",
		playPause:function(event){webAudioApiPlayerObj.playPause();},
		playMedia : function(itemDataObj, aSwitchPlay, isQTrack, dragStartIndx){webAudioApiPlayerObj.playMedia(itemDataObj, aSwitchPlay, isQTrack, dragStartIndx);},
		seekToSec : function(){webAudioApiPlayerObj.seekToSec();},
		jumpToSec : function(sec){webAudioApiPlayerObj.jumpToSec(sec); },
		speedRate : function(rate){ webAudioApiPlayerObj.speedRate(rate); },
		close : function(playingMediaID){ webAudioApiPlayer.pause(); }
	},
	{
		id:2, name:"webVideoPlayer", 
		playPause:function(event){webVideoApiPlayerObj.playPause();},
		playMedia : function(itemDataObj, aSwitchPlay, isQTrack, dragStartIndx){playWebApiVideoMedia(itemDataObj, aSwitchPlay, isQTrack, dragStartIndx);},
		seekToSec : function(){webVideoApiPlayerObj.seekToSec();},
		jumpToSec : function(sec){webVideoApiPlayerObj.jumpToSec(sec); },
		speedRate : function(rate){ webVideoApiPlayerObj.speedRate(rate); },
		close : function(playingMediaID){ if(typeof(player) !== 'undefined'){webVideoApiPlayer.pause(); $.swipebox.close();} } ///if(playingMediaID===1){ $.swipebox.hide();}else{ $('#swipebox-overlay').remove();}}} ///> TODO: Need Work for YouTube to HTML5 Video Player switch and vice versa
	}
]
};

webPlayer = webMediaPlayerMasterObj.webPlayerList[0];

///> YouTube Player Fnc
	function playMediaWebPlayer(itemData, aSwitchPlay=false, isQTrack=false, switchPlayInt=0){

			 ytID= itemData.webUID;
			 var titleYT = itemData.trackTitle;///decodeURIComponent(itemDataArray[4]).replace(/%27/g, /'/);
			 //updateProgSlider=false;
			 masterPlayerUI.pause();
				//console.log("playing playMediaWebPlayer");
				var startTimeSec = 0;
				if(isQTrack===true){ startTimeSec = qPlaylistObj.item[0].startTime;}
				if(ytID.includes('youtube') || ytID.includes('local')){
					if($.swipebox.isOpen===false || typeof $.swipebox.isOpen === 'undefined' || $.swipebox.mediaType !== "youtube"){ ///playrWebIsReady
						 $.swipebox( [
							 { href:ytID, startTime: startTimeSec, title:titleYT}
						 ],	{ autoplayVideos: "1" } );
					 }else if($.swipebox.isOpen)
					 {
						 var youtubeUrl = getYTIDFromURL(ytID);

						// console.log(youtubeUrl +" isQTrack: "+ isQTrack +" : " + startTimeSec +" : switchPlayInt: " +switchPlayInt);
	 					 this.player.loadVideoById( youtubeUrl, startTimeSec);
						 //$.swipebox.showSlide();
					 }

						 }

						 showWebPlayer();
						
						 updateSendVisitorActivity(1, function(){ 
							if(pageData.playTrackData.webUID !== ytID){
								visitorData.uid = pageData.playTrackData.id = youtubeUrl; 
								visitorData.title = pageData.pageTitle = titleYT; 
								visitorData.author = pageData.playTrackData.trackArtist = itemData.trackArtist;
								return true;
							}else{
								return false;
							}
						 });
						// console.log(itemData);

		}

		function showWebPlayer(){

		 if($.swipebox.isHidden===true){
			$( '#swipebox-overlay' ).show();
			$( 'html' ).addClass( 'swipebox-html' );
		 //  $( 'html' ).addClass( 'swipebox-touch' );
			$( window ).trigger( 'resize' );
			$.swipebox.isHidden=false;
			}

			if($("div.ui-header").hasClass('ui-fixed-hidden')===false && $("#swipebox-overlay").hasClass("miniPlayScreen")===false ){
				$( ".ui-header" ).toolbar( "hide" );
			}
		}

	function playNextAddWebPlayer(itemData){ 
		
		insertASlyItem(itemData, 1);
		qPlaylistObj.lastUpdateTime=Date.now();

		localStorage.setObject('qPlaylsitJSON', qPlaylistObj);
	}

	// function playPauseFn(event){	
	// 	activeDevice.playPause(event);
	// 	event.stopPropagation();
	// }

 var playPauseFn = function (event){	
	 
	activeDevice.playMedia(qPlaylistObj.item[0], true, true);

	 playPauseFn = function (event){	
		activeDevice.playPause(event);
		event.stopPropagation();
	}

 }



var tapOnHold=false;

function tapPlayTheNextOne(event){
	tapOnHold=true;
	activeDevice.tapPlayNext();
	event.preventDefault();
}
		function tapPlayNextMPlayer(){ // play the next track in queue list
		///> actionCmd, appMod, actionName
		appStetionServerAction("playnext", "catPlayer", "play");
		}

		function tapPlayNextWebPlayer(){playNextTrackWebPlayer();}

		function tapPlayThePrevOne(event){ // play the previous track from histroy list
				event.preventDefault();
				///> actionCmd, appMod, actionName
				appStetionServerAction("playprev", "catPlayer", "play");
				return false;
		}

		function tapSeekNext(event){ // jump x second forword
				event.preventDefault();
				if(tapOnHold===false){
					activeDevice.seekNextSec();
				}else{tapOnHold=false;}
				return false;
		}

	function seekNextInMPlayer(){
				///> actionCmd, appMod, actionName
				appStetionServerAction("seeknext", "catPlayer", "play");
		}

	function tapSeekPrev(event){ // jump x second backward
		event.preventDefault();
		if(tapOnHold===false){
			activeDevice.seekPrevSec();
		}else{tapOnHold=false;}
		return false;
	}

function seekPrevInMPlayer(){
	///> actionCmd, appMod, actionName
	appStetionServerAction("seekprev", "catPlayer", "play");
}

function seekNextInWebPlayer(){ webPlayer.jumpToSec(7)}
function seekPrevInWebPlayer(){ webPlayer.jumpToSec(-7)}

function tapUPHandler(event){ // add to playPause in queue list
				selectedItem=this;
			//	console.log("mouseUp");
				// event.preventDefault();
				// return false;
		}

function tapSwitchPlay(event){ // add to playPause in queue list
	 var focused = selectedItem;
	 ///$(focused).hide();
		playMediaAction = "switchPlayVid";
		//>playMedia(focused);
		activeDevice.playMedia(focused);
			//	console.log("mouseUp");
				event.preventDefault();
				return false;
		}

function btnPlayNext(event){ // add to play next in queue list

		var focused = selectedItem;
		///playMediaNext(focused);
		activeDevice.playNextAdd(focused);
		event.preventDefault();
		return false;
	}

		function btnQuickPlay( event ){ // play focused track
				var focused = selectedItem;
				playMediaAction = "playVid";
				//>playMedia(focused);
				activeDevice.playMedia(focused);
				event.preventDefault();
				return false;
	}

function goAtItem(event){
	let itemName= $(this).text().replace(/\s+/g, '').toLowerCase();
	commandSimulatorFn("@", itemName);
}
	function btnScreenSize( event ){ // change/toggle video screen size/minimize/maximize
		//// $("[data-role=header]").toolbar({ tapToggle: false });
		
			activeDevice.screenSizeChange();

			updateSendVisitorActivity(2, function(){ visitorData.actionOn = "btnScreenSize"; return true;});

			event.preventDefault();
			return false;
	}

	function screenSizeChangeMediaPlayer(){
		//if( appCStatus==1){ ///> first appClient-Online check by DB
					///> actionCmd, appMod, actionName
					appStetionServerAction("vidScreenSize", "catPlayer", "play");
			//}
	}

	function screenSizeChangeWebPlayer(){
			$("#swipebox-overlay").toggleClass("miniPlayScreen");
			 showWebPlayer();
	}

	function playSpeedUpMediaPlayer(){
					appStetionServerAction("playSpeedUp", "catPlayer", "play");
	}
	function playSpeedDownMediaPlayer(){
					appStetionServerAction("playSpeedDown", "catPlayer", "play");
	}

	$(".slyWrap .frame ul").on("mouseenter", "li", function(){
         $(this).find('.slyImgOverlay').fadeIn(400);
     }).on("mouseleave", "li", function(){
         $(this).find('.slyImgOverlay').stop().fadeOut(100);
     });

	$('body').on("tap", ".delBtn", function(){
			 //	console.log('deldel');
				$("ul.clearfix li").removeClass('active');
				var ele= $(this).closest("li").addClass('active');
				 slySelectedItemAction('delete');
		 });

		 $('body').on("tap", ".playSlyBtn", function(){
					// console.log('playSly');
					 $("ul.clearfix li").removeClass('active');
					 var ele= $(this).closest("li").addClass('active');
						slySelectedItemAction('playSlyItem');
				});

		$('body').on("tap", ".optBtn", function(){
			//	console.log('optBtn');
				$("ul.clearfix li").removeClass('active');
				var ele= $(this).closest("li").addClass('active');
				slySelectedItemAction('moveToPlayNext');
		});

	function showSliderConFn( event ){ // change/toggle video screen size/minimize/maximize
		tapOnHold=true;
		if($("#info").is(":visible")===false){
			$("#info").fadeIn("fast", function(){ showInfo('show_sliderbar');});

				///>? if(wsIsConnected===false){	var apin = setupCred(function(apin){wsConnect_vix(apin);}); }//else{syncNowPlayingMediaData();}
				}else{
						$("#info").fadeOut("fast", function(){ showInfo('');});
							///?clearInterval(sliderProgTimerVar);
					}

			event.preventDefault();
			return false;
	}


var masterPlayerUI = {isPlaying:false, play:function(){updateProgSlider=true;progBarSmoothAni2(true);masterPlayerUI.isPlaying=true;}, pause:function(){updateProgSlider=false;progBarSmoothAni2(false);masterPlayerUI.isPlaying=false;}}

var isSmoothAniEnabled=false;

function progBarSmoothAni2(isPlaying){
	if(isSmoothAniEnabled){
	if(isPlaying===true){
		var durMilSec= mediaDurationInSec*1000;
		var barWidth = ($('.ui-slider-track').width()/100);
			$( ".ui-slider-bg" ).css({ transformOrigin: 'left' })
       .velocity({
        scaleX: barWidth
    },{
      duration: durMilSec,
      easing: "linear",
    });

		} else{
		$( ".ui-slider-bg" ).velocity("stop", true);

		}
	}
}

function progBarSmoothAniX(isPlaying){
	if(isSmoothAniEnabled){
	if(isPlaying===true){
		var durMilSec= mediaDurationInSec*1000;
			$( ".ui-slider-bg" ).animate({
			width: "100%"

			}, {
			queue: false,
			easing: "linear",
			duration:durMilSec/playSpeedRate,
		//step: function(now, fx){ aniTickFn(now);}
			});

		} else{
		$( ".ui-slider-bg" ).stop();

		}
	}
}

var sliderProgTimerVar = null;
var nowPlaySec=0;
var updateProgSlider=true;
var mediaDurationInSec=0;
var playSpeedRateInMilSec=1000;
var playSpeedRate=1; ///> second increment rate

function sliderProgressSetupFn(playStatus, duration, progress){
	mediaDurationInSec = parseInt(duration);
 var mediaProgressInSec = parseInt(progress);

 $("#info").fadeIn("fast", function(){ showInfo('show_sliderbar');});
	// console.log("Durtion: "+mediaDurationInSec);

 $("#show_sliderbar #slider-mini").attr("max", mediaDurationInSec).slider('refresh');
 $("#show_sliderbar #slider-mini").val(mediaProgressInSec).slider("refresh");
 nowPlaySec = mediaProgressInSec;
	 if(playStatus==="playing"){
		//updateProgSlider=true;
		masterPlayerUI.play();
	}else if(playStatus==="paused"){
		// clearInterval(sliderProgTimerVar);
		//updateProgSlider=false;
		masterPlayerUI.pause();
	 }
	  progressBarPlayStart();
}

		///> sec To time Format
		var toHHMMSS = (secs) => {
    var sec_num = parseInt(secs, 10)
    var hours   = Math.floor(sec_num / 3600) % 24
    var minutes = Math.floor(sec_num / 60) % 60
    var seconds = sec_num % 60
    return [hours,minutes,seconds]
        .map(v => v < 10 ? "0" + v : v)
        .filter((v,i) => v !== "00" || i > 0)
        .join(":")
}

function progressBarPlayStart(){
	clearInterval(sliderProgTimerVar);

	sliderProgTimerVar = setInterval(sliderProgressValSetPerSecTimer, playSpeedRateInMilSec);
	//progBarSmoothAni(updateProgSlider);
}

function sliderProgressValSetPerSecTimer(){

if(updateProgSlider){

	nowPlaySec = nowPlaySec+1;
	qPlaylistObj.item[0].startTime=nowPlaySec;
	$("#show_sliderbar #slider-mini").val(nowPlaySec).slider("refresh"); //
		if(nowPlaySec<mediaDurationInSec){

			var tFormat = '- ' + toHHMMSS(mediaDurationInSec-nowPlaySec)
			$('div.timeFormatText').text(tFormat);

			if(nowPlaySec % 30 === 0  ) {
				qPlaylistObj.lastUpdateTime=Date.now();
				localStorage.setObject('qPlaylsitJSON',qPlaylistObj);
				// console.log("40s Time - Saved!!");
				updateSendVisitorActivity(4, function(){ visitorData.actionOn = "time-progress: "+nowPlaySec+' / '+mediaDurationInSec; return true;});
			}
		}else{
			//its equal or grater so clear timer
			clearInterval(sliderProgTimerVar);
		}
	}
}

function sliderTapStartEventFn(){
	//updateProgSlider=false;
	masterPlayerUI.pause();
	//	console.log("Slider Tap Event!!");
}

function sliderTapSlideEventEndFn(event){
	//console.log("Slider Slide/Tap Event Ends!!");
	if(sliderProgChanged){
		activeDevice.goToSecPlay();
	}

sliderProgChanged=false;
}

var sliderProgChanged=false;
function sliderChangeEventFn(event){
	nowPlaySec=parseInt($("#show_sliderbar #slider-mini").val());
	//console.log("Slider Val Change Event!!");
	sliderProgChanged=true;
}


 function searchBoxSelected(event){ // add to playPause in queue list

			 // event.preventDefault();

		}

	$(document).on('swipeleft', '.ui-content', function(event){
		if(event.handled !== true) // This will prevent event triggering more then once
		{
				var nextpage = $.mobile.activePage.next('[data-role="page"]');
				// swipe using id of next page if exists
				if (nextpage.length > 0) {
						$.mobile.changePage(nextpage, {transition: "slide", reverse: false}, true, true);
				}
				event.handled = true;
		}
		return false;
});

$(document).on('swiperight', '.ui-content', function(event){
		if(event.handled !== true) // This will prevent event triggering more then once
		{
			$( "body>[data-role='panel']" ).panel( "open" );
				var prevpage = $(this).prev('[data-role="page"]');
				if (prevpage.length > 0) {
						$.mobile.changePage(prevpage, {transition: "slide", reverse: true}, true, true);
				}
				event.handled = true;
		}
		return false;
});

function getFeedItemsByFilterConfig(postData){
	let filterVal = $("#flip-1").val();
	//var postData =$(event.target).data('documentIds');
	if(filterVal==="off"){
		const result = postData.filter(item => item.type ==="ytFeed");
		postData = result;
		//console.log(filterVal);
	}

	return postData;
}

$('body').on('tap', '.feed-btnlist .ui-btn.feed-btn', function(){ uiEventGetFeed(event, "feed"); return false;} );

$('body').on('tap', '.feed-btnlist .ui-btn.yttrendbtn', getYTTrends );

$('body').on('tap', '.library-list li a.ui-btn', getmediaLibraryItems ); ////>------------XXXXXX

function uiEventGetFeed(event, postPath){ 

	var postData =$(event.target).data('documentIds');

	visitorData.activityType = $(event.target).attr('href').replace(/\//g, '-');

	getYTFeed(postPath, function(){ feedDataStoreObj.page=0; return getFeedItemsByFilterConfig(postData);}, function(data){feedDataStoreObj.initializeResult(data);});
	feedDataStoreObj.postData=postData;
	event.preventDefault();
	event.stopPropagation();
}

function getYTTrends( event ){


		$( ".ui-loader").loader( "show" );

			$.ajax({
									url: "https://canvasonic.com/yttrends",
									type: 'post',
									contentType: 'application/x-www-form-urlencoded; charset=UTF-8',
									data: $('#app-form').serialize(), 
									success: function(data) {

										$( ".ui-loader" ).loader( "hide" );
										searchDataStoreObj.initializeResult();
										// ytSearch=false;
										trendResultList(data)

									},
						error: function(e) {
							//console.log(e.responseText);
						}
					});
			
}

function imgLoadedFeed(imageEle) { ///>>> onload=\'javascript:imgLoadedFeed(this);\'
	//console.log('ImgErr!!: '+$(imageEle).width());
	if($(imageEle).width()===120){
		let parElement = $(imageEle).parent(".fname").parent("li");
		let indx =$( "#ul_id li.ui-li-has-alt" ).index( parElement ) ; 
		if(feedDataStoreObj.data[indx].elementType==="ytFeed"){
			//console.log("Rmv: "+indx);
			
			$(parElement).hide();
			if($(parElement).hasClass('viewSection')){
					$(parElement).removeClass('viewSection');
					$(parElement).next("li").addClass('viewSection');
				}
			//  feedDataStoreObj.data.splice(indx, 1); 
			//  viewItemDataStoreObj = feedDataStoreObj;
		}
	}
    return true;
}

function getYTFeed(postPath, dataTargetScopeFn, loadInitTypeFn){

var postData = dataTargetScopeFn(); ///getFeedItemsByFilterConfig(); //$(event.target).data('documentIds');

if (postData!=null){

	var postToURL = "https://canvasonic.com/"+postPath;
	//if local dev server "http://applinkit.com/api/getelements" : else "http://applinkit.com/getelements" 
	

	$( ".ui-loader").loader( "show" );
								
		$.ajax({
								url: postToURL, // "http://applinkit.com/api/getelements",//"https://canvasonic.com/"+postPath,
								type: 'post',
								contentType: 'application/x-www-form-urlencoded; charset=UTF-8',
								data: {_token: CSRF_TOKEN, itemChannels: JSON.stringify(postData), page: feedDataStoreObj.page, visitor: JSON.stringify(visitorData)}, //$('#app-form').serialize(),
								headers: {'X-CSRF-TOKEN': CSRF_TOKEN},
								success: function(data) {

									$( ".ui-loader" ).loader( "hide" );

									loadInitTypeFn(data);			
									
									 ytFeedResult(data, feedDataStoreObj.initialIndex, 12); //feedDataStoreObj.initialIndex
									 //.console.log(data);
							
								},
					error: function(e) {
						console.log(e.responseText);
					}
				});

				$('.app-page.cardView-page').hide();
		}

//event.preventDefault();
//event.stopPropagation();
		return false;
}


var prvID='';
function ytFeedResult(data, initialIndex, itemLoadCount){ ///>
		//console.log("feedLoded");
		skey='';
		let indx=0;
	$.each(feedDataStoreObj.data.slice(initialIndex, (initialIndex+itemLoadCount)), function(index, item) {

	//if(item.id !== prvID){

		var itemLogoURL='';
			var itemTitle = item.title; //data[index].snippet.title
			var authorName = item.author.name;
			///var filterAuther= encodeURIComponent(authorName);
			var itemDesc = item.description;
			var itemURL;
			var imgURL;
			let listIconClass="carat-r";
			let itemThumbType = "ytThumbImg";

		switch(item.elementType){
			case "ytFeed":
				var vID =	item.id; //data[index].id.videoId;
				var itemURL = 'https://www.youtube.com/watch?v='+vID;
							
				if(typeof item.logoIds !== "undefined"){
					 /// itemLogoURL = "https://lh5.googleusercontent.com/"+item.logoIds[0]+"/AAAAAAAAAAI/AAAAAAAAAAA/" +item.logoIds[1]+"/s50-mo/photo.jpg";
						if(item.logoIds[1]!=="" && typeof item.logoIds[1] !== "undefined"){
					    itemLogoURL = "https://yt3.ggpht.com/"+item.logoIds[0]+"/AAAAAAAAAAI/AAAAAAAAAAA/"+item.logoIds[1]+"/s88-c-k-no-mo-rj-c0xffffff/photo.jpg";
						}else{
					  	itemLogoURL = "https://yt3.ggpht.com/a-/"+item.logoIds[0]+"=s88-c-k-no-mo-rj-c0xffffff";
						}
					 }

				var itemSubType="youtubeAddOrPlay";
			//	clickmickSrt = index+','+itemSubType+','+itemURL+',,'+filterTitle+','+filterAuther;
				imgURL = 'https://i.ytimg.com/vi/' + vID + '/hqdefault.jpg';
				//listIconClass="carat-r";

			break;
			case "rssFeed":
					itemURL=item.id;
					var itemSubType=item.elementSubType;
				//	clickmickSrt = index+','+itemSubType+','+itemURL+',,'+filterTitle+','+filterAuther;
					if(typeof item.logoIds !== "undefined"){   imgURL = item.logoIds[1];}
					
					if(itemSubType==="rssWeb"){
						listIconClass="ui-icon-bars";
						itemLogoURL = "https://logo-core.clearbit.com/"+item.logoIds[0];
					}else{
						itemLogoURL = imgURL;
					}

					itemThumbType = "webThumbImg";
			
			break;
		}

		/////let itemData ={"id":index, "trackType":itemSubType,"webUID": itemURL, "playlistUID":"", "trackTitle":itemTitle, "trackArtist":authorName, "imgURI":imgURL, "imgWidth":'', "logoURL": itemLogoURL, "startTime":'', "trackDuration":''};
		let objIndex = index+initialIndex;
		///// feedDataStoreObj.item[objIndex]=itemData;
		 feedDataStoreObj.data[objIndex].id=objIndex;

		 feedDataStoreObj.data[objIndex].trackType=itemSubType;
		 feedDataStoreObj.data[objIndex].elementSubType=itemSubType;

		 feedDataStoreObj.data[objIndex].webUID=itemURL;
		 feedDataStoreObj.data[objIndex].playlistUID="";
		// feedDataStoreObj.data[objIndex].trackArtist= item.author.name;
		 feedDataStoreObj.data[objIndex].imgURL=imgURL;
		 feedDataStoreObj.data[objIndex].logoURL=itemLogoURL;

		///
		var viewSection = "";
		var viewSnapEleIndx=objIndex;
		if(viewSnapEleIndx % 2 == 0 && viewSnapEleIndx >0) {viewSection="viewSection"; }

		var elementHTML= '<li class=\''+viewSection+'\'><a class=\'fname\' href=\''+itemURL+'\' data-index=\'' + objIndex + '\' onclick="return false;"> <img class=\'ui-li-thumb feedItemThumb ' + itemThumbType + '\' src=\'' + imgURL + '\' data-index=\'' + objIndex + '\' onload=\'javascript:imgLoadedFeed(this);\' ></img><h2	><span id="itemTitle" data-index=\'' + index + '\' onclick="tapToPlay(event); return false;">' + itemTitle +'</span><span id="itemDescription">'+ itemDesc+'</span><span id="itemImgBlock"><img src="'+ itemLogoURL+'"/></span><span id="itemInfoBar">'+ authorName+'</span></h2><p class="ui-li-aside"></p></a><a	href=\'#\' data-index=\'' + objIndex + '\' data-icon=\''+listIconClass+'\' class=\''+listIconClass+'\' width=\'60px\' data-position-to=\'window\' data-transition=\'pop\'>Play</a></li>';
	
		$('.listView-page #ul_id').append(elementHTML);

		//prvID=vID;
		indx++;
		//}
	});

		$('.listView-page #ul_id').listview('refresh');
		adjustPageInfinityLoad();

		feedDataStoreObj.initialIndex += indx; ///= Object.keys(feedDataStoreObj.data).length; //+=indx; //itemLoadCount;
		itemResulLodadMakeScrollReady(initialIndex);
		viewItemDataStoreObj = feedDataStoreObj;
}



function itemResulLodadMakeScrollReady(initialIndex){
	$.scrollify.update();
			if(initialIndex===0 && feedDataStoreObj.page===0){	
			$.scrollify.move(0);
			///>div#rootContainer ///>
			$('html, body').animate({ scrollTop: 0 }, 600, function(){});
			}
}

function addMoreFeedItem(){ ///>> loding alrady gathared Data (via API) in to UI

	if(feedDataStoreObj.dataLength>feedDataStoreObj.initialIndex){
	ytFeedResult(feedDataStoreObj.data, feedDataStoreObj.initialIndex, 12);
	}else{
		if(feedDataStoreObj.postData.length>1){
			feedDataStoreObj.page++;
			getYTFeed("feed", function(){ return getFeedItemsByFilterConfig(feedDataStoreObj.postData);}, function(data){feedDataStoreObj.loadNewPage(data);});
			//console.log("Page Loaded!!");
		}else{
			feedDataStoreObj.page++;
			getYTFeed("feedsig", function(){ return getFeedItemsByFilterConfig(feedDataStoreObj.postData);}, function(data){feedDataStoreObj.loadNewPage(data);});
			//console.log("feedsig Page Loaded!!");
		}
	}
}

function playYTFeedVidNowFn(postPath, vidTargetData){

	var postData =JSON.parse(vidTargetData); //$(event.target).data('documentIds');
	//console.log(postData);

		$.ajax({
				url: "https://canvasonic.com/"+postPath, //"feed"
				type: 'post',
				contentType: 'application/x-www-form-urlencoded; charset=UTF-8',
				data: {_token: CSRF_TOKEN, itemChannels: JSON.stringify(postData)}, //$('#app-form').serialize(),
				headers: {'X-CSRF-TOKEN': CSRF_TOKEN},
				success: function(data) {
					
					let itemObj = data[0];
					var trackType="";
					var webUID;
					var imgURL="";
					switch(itemObj.elementType){
							case "ytFeed":
								var vID =	itemObj.id; 
								webUID = 'https://www.youtube.com/watch?v='+vID;
								trackType= "youtubeAddOrPlay";
								imgURL = 'https://i.ytimg.com/vi/' + vID + '/hqdefault.jpg';
							break;
							case "rssFeed":
								webUID=itemObj.id;
								trackType=itemObj.elementSubType;
								if(typeof itemObj.logoIds !== "undefined"){ itemLogoURL = itemObj.logoIds[0];  imgURL = itemObj.logoIds[1];}
							break;
						}
		
						let itemData ={"id":0, "trackType":trackType,"webUID": webUID, "playlistUID":"", "trackTitle":itemObj.title, "trackArtist":itemObj.author.name, "imgURI":imgURL, "imgWidth":'', "logoURL": "", "startTime":0, "trackDuration":0};

						var playNow=true; ///> TODO: check last command in input box
					
						if(playNow===true){

							playMediaAction = "playVid";	
							activeDevice.playMedia(itemData);

						}else if(playNow===false) {
						
							activeDevice.playNextAdd(itemData);
						}

				},
	error: function(e) {
		console.log(e.responseText);
					}
				});
}

function reConnectWithAppClient(){
	delete_cookie('chanUID');
	$("#popupLogin-Btn").trigger("click");
}

function delete_cookie(name) {
	document.cookie = name +'=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;';
}


function commandActionPostToSrv(actionPath){
					 $.ajax({
								url: basePath+"/"+actionPath,
								type: 'post',
								contentType: 'application/x-www-form-urlencoded; charset=UTF-8',
								dataType: 'json',
								data: $('#app-form').serialize(),
								success: function(data) {
								 searchDataStoreObj.data = data;
								 searchResult(data, 0);

								},
					error: function(e) {
						console.log(e.responseText);
					}
				});
}

function addfollowCmdFn(inputVal){commandActionPostToSrv("addfeed");}
function playCmdFn(inputVal){

	if(filterArray.length===0 ) ///|| objFilter===false // filterArray.length > 0 &&
		{
			///>> simple Keyword search 'Play' : 'Play wind of change'
			var voiceInputType="speechCmd";
			var vioceCmdVal=inputVal.trim();
			//console.log(vioceCmdVal);
			 voicePlayRoute(vioceCmdVal, voiceInputType);
		}
		else if(filterArray[0].itemType === "ytFeed" || itemObjFilterArray.length>0){
				///>> get the selected feeds frist item from Web and play
				//var feedData="[{'id':'"+ filterArray[0].webUID+ "', 'type':'" + filterArray[0].itemSubType+"'}]";
				var feedData= "[{\"id\":\""+itemObjFilterArray[0].webUID+"\", \"subType\":\""+itemObjFilterArray[0].itemSubType+"\"}]";
				//console.log(feedData);
				///> TODO: need a server POST for YT channels frist video return, and then post the url in 'voicePlayRoute()'
				playYTFeedVidNowFn("feed",feedData);

			}
}

///> '@' cmd

/// Go, Resume, Go To >
function playbackControlCmdFn(inputVal){	var voiceInputType="speechCmd"; var vioceCmdVal=inputVal.trim(); console.log(vioceCmdVal); voicePlayRoute(vioceCmdVal, voiceInputType); }

var cmdSearch=true; //> to differentiate user keyword-searh and comman-antion
var ytSearch=true;var sptSearch=true;var libSearch=true;
var cmdTriggerOn=false;
var actionCmdName;
var objFilterType=0; // 0 = string; 1 = command; 2 = itemObject; 3 = target; 4 = condition
var objFilter=false;
var targetFilter=false;
/// flexObjArray
/// flexObjFn
//DOTO NOTE: need to add 'onSelectFn' obj in JSON 'feedItemObj' as its a common standerd Object property in 'actionCmdList', & 'hub[0]["hub.envo"][0]'
/// var actionCmdList = new Array("addfollow", "af", "play", "resume", "go", "yt", "sp", "lm","addTo", "favThis");

///>>>{"item":[{"id":"", "trackType":"","webUID": "", "playlistUID":"", "trackTitle":"", "artistName":""}]};
var qPlaylistObj={"item":[{"createdDate":1543367118856,"id":"12","imgURI":"https://i.ytimg.com/vi/-O5kNPlUV7w/mqdefault.jpg","imgWidth":178,"playlistUID":"","startTime":0,"trackArtist":"Kurzgesagt – In a Nutshell","trackDuration":456.921,"trackTitle":"Why Beautiful Things Make us Happy – Beauty Explained","trackType":"youtubeAddOrPlayQueue","webUID":"https://www.youtube.com/watch?v=-O5kNPlUV7w","clickmickEventObj":{"isQueueTrack":true,"playWasASwitchPlay":true,"switchPlayIndx":1,"playTimestamp":1543511535291}},{"createdDate":1543367119935,"id":"101","imgURI":"https://i.ytimg.com/vi/IFngqro5yyQ/mqdefault.jpg","imgWidth":178,"playlistUID":"","startTime":0,"trackArtist":"Cousins Explained","trackDuration":979,"trackTitle":"Cousins Explained","trackType":"youtubeAddOrPlayQueue","webUID":"https://www.youtube.com/watch?v=IFngqro5yyQ"},{"createdDate":1543367120214,"id":"119","imgURI":"https://i.ytimg.com/vi/1csFTDXXULY/mqdefault.jpg","imgWidth":178,"playlistUID":"","startTime":0,"trackArtist":"Can you solve the false positive riddle? - Alex Gendler","trackDuration":979,"trackTitle":"Can you solve the false positive riddle? - Alex Gendler","trackType":"youtubeAddOrPlayQueue","webUID":"https://www.youtube.com/watch?v=1csFTDXXULY"},{"createdDate":1543367120250,"id":"121","imgURI":"https://i.ytimg.com/vi/d3zTfXvYZ9s/mqdefault.jpg","imgWidth":178,"playlistUID":"","startTime":0,"trackArtist":"Time Travel in Fiction Rundown","trackDuration":979,"trackTitle":"Time Travel in Fiction Rundown","trackType":"youtubeAddOrPlayQueue","webUID":"https://www.youtube.com/watch?v=d3zTfXvYZ9s"},{"createdDate":1543367120369,"id":"128","imgURI":"https://i.ytimg.com/vi/IgUlowmSeHo/mqdefault.jpg","imgWidth":178,"playlistUID":"","startTime":0,"trackArtist":"How A Messed Up Childhood Affects You In Adulthood","trackDuration":979,"trackTitle":"How A Messed Up Childhood Affects You In Adulthood","trackType":"youtubeAddOrPlayQueue","webUID":"https://www.youtube.com/watch?v=IgUlowmSeHo"},{"createdDate":1543367119304,"id":"63","imgURI":"https://i.ytimg.com/vi/6PiyUjVxukI/mqdefault.jpg","imgWidth":178,"playlistUID":"","startTime":0,"trackArtist":"What is the universe expanding into? - Sajan Saini","trackDuration":979,"trackTitle":"What is the universe expanding into? - Sajan Saini","trackType":"youtubeAddOrPlayQueue","webUID":"https://www.youtube.com/watch?v=6PiyUjVxukI"},{"createdDate":1543367119134,"id":"50","imgURI":"https://i.ytimg.com/vi/NtQkz0aRDe8/mqdefault.jpg","imgWidth":178,"playlistUID":"","startTime":0,"trackArtist":"How We Could Build a Moon Base TODAY – Space Colonization 1","trackDuration":979,"trackTitle":"How We Could Build a Moon Base TODAY – Space Colonization 1","trackType":"youtubeAddOrPlayQueue","webUID":"https://www.youtube.com/watch?v=NtQkz0aRDe8"},{"createdDate":1543367118881,"id":"20","imgURI":"https://i.ytimg.com/vi/7jMlFXouPk8/mqdefault.jpg","imgWidth":178,"playlistUID":"","startTime":0,"trackArtist":"Pink Floyd - High Hopes (Official Music Video)","trackDuration":979,"trackTitle":"Pink Floyd - High Hopes (Official Music Video)","trackType":"youtubeAddOrPlayQueue","webUID":"https://www.youtube.com/watch?v=7jMlFXouPk8"},{"createdDate":1543367118913,"id":"27","imgURI":"https://i.ytimg.com/vi/8lgg-pVjOok/mqdefault.jpg","imgWidth":178,"playlistUID":"","startTime":0,"trackArtist":"Why should you read Edgar Allan Poe? - Scott Peeples","trackDuration":979,"trackTitle":"Why should you read Edgar Allan Poe? - Scott Peeples","trackType":"youtubeAddOrPlayQueue","webUID":"https://www.youtube.com/watch?v=8lgg-pVjOok"},{"createdDate":1543367118918,"id":"28","imgURI":"https://i.ytimg.com/vi/eFjjO_lhf9c/mqdefault.jpg","imgWidth":178,"playlistUID":"","startTime":0,"trackArtist":"Bryan Adams - Summer Of '69","trackDuration":979,"trackTitle":"Bryan Adams - Summer Of '69","trackType":"youtubeAddOrPlayQueue","webUID":"https://www.youtube.com/watch?v=eFjjO_lhf9c"},{"createdDate":1543367118843,"id":"6","imgURI":"https://i.ytimg.com/vi/gyCY5BLi4cs/mqdefault.jpg","imgWidth":178,"playlistUID":"","startTime":0,"trackArtist":"Philosophy by Arthur Schopenhauer","trackDuration":979,"trackTitle":"Philosophy by Arthur Schopenhauer","trackType":"youtubeAddOrPlayQueue","webUID":"https://www.youtube.com/watch?v=gyCY5BLi4cs"},{"createdDate":1543367118979,"id":"35","imgURI":"https://i.ytimg.com/vi/a01QQZyl-_I/mqdefault.jpg","imgWidth":178,"playlistUID":"","startTime":0,"trackArtist":"Queen - Under Pressure (Official Video)","trackDuration":979,"trackTitle":"Queen - Under Pressure (Official Video)","trackType":"youtubeAddOrPlayQueue","webUID":"https://www.youtube.com/watch?v=a01QQZyl-_I"},{"createdDate":1543367118999,"id":"38","imgURI":"https://i.ytimg.com/vi/OMOGaugKpzs/mqdefault.jpg","imgWidth":178,"playlistUID":"","startTime":0,"trackArtist":"The Police - Every Breath You Take","trackDuration":979,"trackTitle":"The Police - Every Breath You Take","trackType":"youtubeAddOrPlayQueue","webUID":"https://www.youtube.com/watch?v=OMOGaugKpzs"},{"createdDate":1543367119017,"id":"40","imgURI":"https://i.ytimg.com/vi/tn0lqMuGguw/mqdefault.jpg","imgWidth":178,"playlistUID":"","startTime":0,"trackArtist":"Why It's Almost Impossible to Jump Higher Than 50 Inches | WIRED","trackDuration":979,"trackTitle":"Why It's Almost Impossible to Jump Higher Than 50 Inches | WIRED","trackType":"youtubeAddOrPlay","webUID":"https://www.youtube.com/watch?v=tn0lqMuGguw"},{"createdDate":1543367118828,"id":"0","imgURI":"https://i.ytimg.com/vi/NowjSrlp0Hg/mqdefault.jpg","imgWidth":178,"playlistUID":"","startTime":91,"trackArtist":"The Emptiness of Existence by Arthur Schopenhauer","trackDuration":979,"trackTitle":"The Emptiness of Existence by Arthur Schopenhauer","trackType":"youtubeAddOrPlayQueue","webUID":"https://www.youtube.com/watch?v=NowjSrlp0Hg","clickmickEventObj":{"isQueueTrack":true,"playWasASwitchPlay":false,"playerStatus":"paused","switchPlayIndx":0}},{"createdDate":1543367119027,"id":"41","imgURI":"https://i.ytimg.com/vi/MbXWrmQW-OE/mqdefault.jpg","imgWidth":178,"playlistUID":"","startTime":0,"trackArtist":"The Police - Message In A Bottle","trackDuration":979,"trackTitle":"The Police - Message In A Bottle","trackType":"youtubeAddOrPlayQueue","webUID":"https://www.youtube.com/watch?v=MbXWrmQW-OE"},{"createdDate":1543367119049,"id":"43","imgURI":"https://i.ytimg.com/vi/J4Ej3Q_QquA/mqdefault.jpg","imgWidth":178,"playlistUID":"","startTime":0,"trackArtist":"Why the Weak Nuclear Force Ruins Everything","trackDuration":979,"trackTitle":"Why the Weak Nuclear Force Ruins Everything","trackType":"youtubeAddOrPlayQueue","webUID":"https://www.youtube.com/watch?v=J4Ej3Q_QquA"},{"createdDate":1543367119377,"id":"66","imgURI":"https://i.ytimg.com/vi/QDYfEBY9NM4/mqdefault.jpg","imgWidth":178,"playlistUID":"","startTime":0,"trackArtist":"Let It Be (Remastered 2009)","trackDuration":979,"trackTitle":"Let It Be (Remastered 2009)","trackType":"youtubeAddOrPlayQueue","webUID":"https://www.youtube.com/watch?v=QDYfEBY9NM4"},{"createdDate":1543367119490,"id":"73","imgURI":"https://i.ytimg.com/vi/9P6rdqiybaw/mqdefault.jpg","imgWidth":178,"playlistUID":"","startTime":0,"trackArtist":"Wormholes Explained – Breaking Spacetime","trackDuration":979,"trackTitle":"Wormholes Explained – Breaking Spacetime","trackType":"youtubeAddOrPlayQueue","webUID":"https://www.youtube.com/watch?v=9P6rdqiybaw"},{"createdDate":1543367119575,"id":"78","imgURI":"https://i.ytimg.com/vi/sv34BbEjrwo/mqdefault.jpg","imgWidth":178,"playlistUID":"","startTime":0,"trackArtist":"Eagles - Hotel California (Lyrics)","trackDuration":979,"trackTitle":"Eagles - Hotel California (Lyrics)","trackType":"youtubeAddOrPlayQueue","webUID":"https://www.youtube.com/watch?v=sv34BbEjrwo"},{"createdDate":1543367119907,"id":"99","imgURI":"https://i.ytimg.com/vi/BHIo6qwJarI/mqdefault.jpg","imgWidth":178,"playlistUID":"","startTime":0,"trackArtist":"Public Service Broadcasting - Go!","trackDuration":979,"trackTitle":"Public Service Broadcasting - Go!","trackType":"youtubeAddOrPlayQueue","webUID":"https://www.youtube.com/watch?v=BHIo6qwJarI"},{"createdDate":1543367119949,"id":"102","imgURI":"https://i.ytimg.com/vi/MbXWrmQW-OE/mqdefault.jpg","imgWidth":178,"playlistUID":"","startTime":0,"trackArtist":"The Police - Message In A Bottle","trackDuration":979,"trackTitle":"The Police - Message In A Bottle","trackType":"youtubeAddOrPlayQueue","webUID":"https://www.youtube.com/watch?v=MbXWrmQW-OE"},{"createdDate":1543367119992,"id":"105","imgURI":"https://i.ytimg.com/vi/ewc3ziZ8ReI/mqdefault.jpg","imgWidth":178,"playlistUID":"","startTime":0,"trackArtist":"How To Become Diplomatic","trackDuration":979,"trackTitle":"How To Become Diplomatic","trackType":"youtubeAddOrPlayQueue","webUID":"https://www.youtube.com/watch?v=ewc3ziZ8ReI"},{"createdDate":1543367120007,"id":"106","imgURI":"https://i.ytimg.com/vi/fJ9rUzIMcZQ/mqdefault.jpg","imgWidth":178,"playlistUID":"","startTime":0,"trackArtist":"Queen - Bohemian Rhapsody (Official Video)","trackDuration":979,"trackTitle":"Queen - Bohemian Rhapsody (Official Video)","trackType":"youtubeAddOrPlayQueue","webUID":"https://www.youtube.com/watch?v=fJ9rUzIMcZQ"},{"createdDate":1543367120021,"id":"107","imgURI":"https://i.ytimg.com/vi/QrcmojhFmzY/mqdefault.jpg","imgWidth":178,"playlistUID":"","startTime":0,"trackArtist":"History vs. Augustus - Peta Greenfield & Alex Gendler","trackDuration":979,"trackTitle":"History vs. Augustus - Peta Greenfield & Alex Gendler","trackType":"youtubeAddOrPlayQueue","webUID":"https://www.youtube.com/watch?v=QrcmojhFmzY"},{"createdDate":1543367120037,"id":"108","imgURI":"https://i.ytimg.com/vi/2-MLV_RJ6KQ/mqdefault.jpg","imgWidth":178,"playlistUID":"","startTime":0,"trackArtist":"The (mostly) true story of hobo graffiti","trackDuration":979,"trackTitle":"The (mostly) true story of hobo graffiti","trackType":"youtubeAddOrPlayQueue","webUID":"https://www.youtube.com/watch?v=2-MLV_RJ6KQ"}],"lastUpdateTime":1543511653225}	

	function actionCommandProcess(inputString) {

		var s = inputString.trim().toLowerCase();//.charAt(0); //inputString.replace(/\s+/g, '');//
		//console.log(s+" trig this");
		if(s=="lm"){
				trrigerASingleSearchOption("lm");
		}
		else if(s=="yt" ){
				trrigerASingleSearchOption("yt");

		}else if(s=="sp" ){
				trrigerASingleSearchOption("sp");

		}else if(inputString=="" && cmdTriggerOn==true){
				//> resetDefault Search option
		}
		else{
			var sIn = actionCmdFilterArray[0];//inputString.substring(1,3).toLowerCase();
			console.log(sIn.item.cmd);
			//var inCmdList = actionCmdList.includes(sIn);

			//if(inCmdList===true){
				cmdSearch=false;
				actionCmdName=sIn.item.cmd;
				cmdTriggerOn=true;
				gTrigKey=actionCmdName;//$('#search-mini').val().trim();
				console.log(s+" trig this ActionCmd!!!");
			//}

			if(typeof actionCmdFilterArray[0].item.nextCmdType[0] === "function"){
					actionCmdFilterArray[0].item.nextCmdType[0]();
					console.log('After jsonFN');
				}

		}
	}

var actionCmdFilterArray ;
	function showAtionCmdFilterListUI(inActionCmdText){ ///> show on First SPACE

		var search = inActionCmdText.toUpperCase();
			var inVal;

		//  actionCmdFilterArray = jQuery.grep(actionCmdList, function(items) {
		//   //  return value.item.cmd.toUpperCase().indexOf(search) >= 0;
		// 			inVal = items.item.cmd.toUpperCase().indexOf(search);
		// 	    if( inVal >= 0){
		// 				items.item.indexVal=inVal;
		// 				return items.item;
		// 			}
		// });

		// actionCmdFilterArray = actionCmdList.filter(function (items) {
		// 	inCmdVal = items.item.cmd.toUpperCase().indexOf(search);
		// 	inAliasVal = items.item.alias.toUpperCase().indexOf(search);
	  //   if( inCmdVal >= 0 || inAliasVal >= 0){
		// 		items.item.indexVal=inCmdVal+inAliasVal;
		// 		return items.item;
		// 	}
		// });

		// actionCmdFn();

	}

	function commandSimulatorFn(cmdStr, actionPropertyStr){ ////>>> This TEST Fn is to simulate the Typing Command with the Keyboad for UI mode
	
	/// filter Cmd
	showAtionCmdFilterListUI(cmdStr);

	if (actionCmdFilterArray.length > 0) {
			///> 'space' cmd 'space'
			$('#search-mini').val(" " + actionCmdFilterArray[0].item.cmd + " ");
			let inputTotalVal=$('#search-mini').val();
			actionCommandProcess(inputTotalVal);
			///
			$('#search-mini').val( inputTotalVal + actionPropertyStr);
			inputTotalVal=$('#search-mini').val();
			$.myinputText = inputTotalVal;
			/// filter 'actionProperty'
			var avtionVal = inputTotalVal.trim(); //$.myinputText;///$
			avtionVal = avtionVal.substr(gTrigKey.length + 1);
			showFilterGroupItemListUI(avtionVal, activeFilterObj); 
			/// execute>>
			actionCmdFilterArray[0].item.onExecute(inputTotalVal);
			}
}

var gTrigKey="";

function isValidURL(str) {
   var a  = document.createElement('a');
   a.href = str;
   return (a.host && a.host != window.location.host);
}

	function trrigerASingleSearchOption(searchOn){

			if(searchOn=='yt'){
				ytSearch=true;
				sptSearch=false;
				libSearch=false;

			}
			cmdSearch=true;
			cmdTriggerOn=true;
	}

	function resetToDefaultSearchOption(){

		if(cmdTriggerOn){
				$('.ui-controlgroup-controls input[type=checkbox]').each(function( index ) {

						var sibLabel=$(this).siblings('label');
						var selectedVal = $(sibLabel).text();
						var actionVal=true;
						if ($(this).is(":checked")) {
								if(selectedVal=="YouTube"){ytSearch=actionVal;console.log('YT');} else
								if(selectedVal=="Library"){libSearch=actionVal;console.log('Lib');} else
								if(selectedVal=="Spotify"){sptSearch=actionVal;console.log('SP');}
						}

					});

						cmdTriggerOn=false;
						cmdSearch=true;
						$("#conPCenterContainer ul").html("");
						 $('#conPanel').hide();
						console.log('trigged is off');
			}

			$.myinputText="";
			//activeDevice = hub[0]["hub.envo"][0].defaultDevice;
			setDefaultDeviceAsActiveDeviceFn();
	}

	function getTopListItemElement(){
		if($.scrollify.currentIndex()>0){return $.scrollify.current();}
		else{ var itemTop = $('#ul_id li:first');	return itemTop; }
	}

var selcNx;
var numKeyPressed=null;
	function showNumersOnCtrlPress(keyDown){

		var itemTop = getTopListItemElement();
		 selcNx = $(itemTop).nextAll('li:visible:lt(9)').andSelf();

		 $(selcNx).each(function( index ) {
			if(keyDown){

				$(this).children('.fname').children('.ui-li-aside').text(index+1);
			}
			else{
				 $(this).children('.fname').children('.ui-li-aside').text("");
			}
			//console.log(index);
			});

		 ///.. if(keyDown==true && numKeyPressed!=null){	console.log('fade'); $(selcNx).get(String.fromCharCode(numKeyPressed)).fadeOut();	 }

	}


var keyTargetItem;
function crtlAndNumbKeyPressed(isShiftTrue){

// console.log(numKeyPressed);
 targetEle =$(selcNx).eq(numKeyPressed-1);
 
 //var targetEle = $(keyTargetItem).children('a:first');
 let indx= $(targetEle).index();//.data('index');
 //console.log(indx);
 ///indx = ((viewItemDataStoreObj.page+1)*50)-indx;
 let itemData =itemEventToObject(indx, viewItemDataStoreObj);

 if(isShiftTrue==false){
	 	playMediaAction = "playVid";
		activeDevice.playMedia(itemData);

	}else if(isShiftTrue==true) {
		activeDevice.playNextAdd(itemData);
	}
}

	$(".ui-collapsible-heading-toggle").find(".ui-btn-icon-left:after").bind("click", function (event) {
										var type = collapsibleHeading.is(".ui-collapsible-heading-collapsed") ? "expand" : "collapse";
										console.log('collapse');
										collapsible.trigger(type);
										event.preventDefault();
								});

///> Voice-Play-Route
		function voicePlayRoute(voiceTextString, voiceInputType){

			//var player = $("#select-choice-0 option:selected").val(); //voicePlayRoute
				if( defMediaDeviceIndx===0){ ///> web-Module/Channel selected
					///> voice play on web player
							voicePlayWebAction(voiceTextString, playOnWebVideoPlayer);
				}else{
					//voiceCmdForRootStation(voiceTextString, voiceInputType);
					//. activeDevice.appScript[3](voiceTextString, voiceInputType); ///> [3] = is voice play
					//alert('ss');
					 activeDevice.voiceCmd(voiceTextString, voiceInputType);
				}
		}

///> voice play on web player
		function voicePlayWebAction(voiceTextString, callbackFn){

			console.log(voiceTextString);
			$('#nextPageTokenInput').val('');
			///?? $('#ul_id').html('');
			skey = speechTextToSearchableText(voiceTextString);
			$("#app-form #search-mini").val(skey);
			$('#searchKey').val(skey);

			$.ajax({
					 url: ytSearchUrl, //> ytSearchUrl+voiceTextString
					 type: 'post',
					 contentType: 'application/x-www-form-urlencoded; charset=UTF-8',
					 dataType: 'json',
					 data: $('#app-form').serialize(),
					 success: function(data) {
						 
						callbackFn(data);
						///?? searchResult(data, true);
						skey= ''; //??
					 },
			 	 error: function(e) {
				 console.log(e.responseText);
		 	}
	 });

};

function speechTextToSearchableText(speechTxt){

	if(speechTxt.includes('play')){ let wordArray = speechTxt.split(' '); if( wordArray[0]==='play'){wordArray.splice(0, 1); speechTxt=wordArray.join(' ');}}
	return speechTxt;
}

function playOnWebVideoPlayer(dataResults){
	///> this Fn will play frist item on web player (made for voice play on webApp)

	let itemData = getFirstItemData(dataResults); ////itemData = addNowPlayEventObj(itemData);
	
	webMediaPlayerMasterObj.playMedia(itemData); ///>> playMediaWebPlayer(itemData);

}

function getFirstItemData(dataResults){

	let item = dataResults.results[0];

	let title = item.snippet.title; //data[index].snippet.title;
	let vID =	item.id.videoId; //data[index].id.videoId;
	let vidURL = 'https://www.youtube.com/watch?v='+vID;
	let index=0;
	let trackType ="youtubeAddOrPlay";
	let playlistUID=""; let autherName=""; let imgURL=""; let logoURL="";
	
	let itemData ={"id":index, "trackType":trackType,"webUID": vidURL, "playlistUID": playlistUID, "trackTitle":title, "trackArtist":autherName, "imgURI":imgURL, "imgWidth":'', "logoURL": logoURL, "startTime":0, "trackDuration":0};
	
	return itemData;
}

function autoSuggestFn(keyWord){

    jQuery.ajax({
      type: "POST",
      url: "https://suggestqueries.google.com/complete/search?hl=en&ds=yt&client=youtube&hjson=t&cp=1",
      dataType: 'jsonp',
      data: jQuery.extend({
        q: keyWord
      }, {  }),
      success: function(data){
        //console.log(data[1]);
        $("#conPCenterContainer ul").html("");
        obj = data[1];
        jQuery.each( obj, function( index, value ) {
          //sqValue.push(value[0]);
          	$("#conPCenterContainer ul").append("<li class='cmdListItem'><span class='cmdTxtDisplay'>"+value[0]+"</span><span class='cmdIndex'>"+(index+1)+"</span></li>");
        });
      }
    });

	youtubeLiveSearch();
}

var liveSearchTimer;
function youtubeLiveSearch(){
	window.clearTimeout(liveSearchTimer);
    liveSearchTimer = window.setTimeout(function(){
		loadLiveSearchList(); 
    },1300);
}

function processLiveInputMessage(inputStr){
	///> TODO: check itput test if its a message/link-url/message-with-url
	// switch(inputStr){
	// 	case "": 
	// 	break;
	// 	case "":
	// 	break;
	// }
}

function loadLiveSearchList(){
	// console.log('going live !!');
	$.myinputText =	$('#search-mini').val().trim(); //$('#searchKey').val(skey);
	 var htmlSearch='';
	// $('#nextPageTokenInput').val('');

	if($.myinputText !==''){
		$.ajax({
				url: ytSearchUrl,
				type: 'post',
				contentType: 'application/x-www-form-urlencoded; charset=UTF-8',
				dataType: 'json',
			
				data: {_token: CSRF_TOKEN, qkey: $.myinputText },
				success: function(data) {
					cmdSearchDataStoreObj.data = data.results;
			$.each(data.results.slice(0,8), function(index, item) {

				var vTitle = item.snippet.title; //data[index].snippet.title;
				var vID =	item.id.videoId; //data[index].id.videoId;
				var vidURL = 'https://www.youtube.com/watch?v='+vID;
		
				cmdSearchDataStoreObj.data[index].id=index;
				cmdSearchDataStoreObj.data[index].trackType= "youtubeAddOrPlay";//itemSubType;
				cmdSearchDataStoreObj.data[index].webUID=vidURL;
				cmdSearchDataStoreObj.data[index].playlistUID="";

				cmdSearchDataStoreObj.data[index].title=vTitle;
				cmdSearchDataStoreObj.data[index].author = {name:""};

				cmdSearchDataStoreObj.data[index].imgURL=""; //imgURL;
				cmdSearchDataStoreObj.data[index].logoURL=""; //itemLogoURL;

				htmlSearch +=("<li class='cmdListItem'><span class='cmdTxtDisplay' ><a class=\'ui-li-thumb fname\' href=\'"+vidURL+"\' > <img	class=\'thmbImg cmd-li-thumb\'  src=\'https://i.ytimg.com/vi/"+ vID + "/mqdefault.jpg\' data-index=\'" + index + "\' ></img><p>" + vTitle + "</p></a></span><span class='cmdIndex'>"+(index+1)+"</span></li>");
			
			});
					$("#conPCenterContainer ul").prepend(htmlSearch);
					///viewItemDataStoreObj = searchDataStoreObj;
				},
				error: function(e) {
					console.log(e.responseText);
				}
			});
	}
}

var defMediaDeviceIndx;
function selectActiveDevice(deviceIndex)
{
	defMediaDeviceIndx=deviceIndex;
	//console.log("playerSelect: "+defMediaDeviceIndx);
	beamModeOn=false;
	activeDevice =  hub[0]["hub.envo"][0]['devices'][defMediaDeviceIndx].item;
	activeDevice.onSelectFn(); ///> to run specefic DeviceApp function
	hub[0]["hub.envo"][0]['defaultDevice']=activeDevice;
	 $('#select-choice-0 select').val(activeDevice.name);
	 $('#select-choice-0-button span').text(activeDevice.description);
	 localStorage.setItem('playerSelect', defMediaDeviceIndx);
}

function initialActiveDeviceSelection(){

		if(localStorage.getItem('playerSelect')){
					 var deviceIndex=parseInt(localStorage.getItem('playerSelect'));
					 selectActiveDevice(deviceIndex);
						//$('#select-choice-0 option:selected').val(activeDevice.name);
				}
		else{
			activeDevice =  hub[0]["hub.envo"][0]['devices'][0].item;
		}

		 initialQPlaylistSelectionOnPageLoad();
	}

function initialQPlaylistSelectionOnPageLoad(){
	if(localStorage.getItem('qPlaylsitJSON')){
		qPlaylistObj = localStorage.getObject('qPlaylsitJSON');
		makeSlyHTMLFromQPlayerObj(qPlaylistObj);
	}else{
		qPlaylistObj.lastUpdateTime=0;
		makeSlyHTMLFromQPlayerObj(qPlaylistObj);
	}
}

var avtiveDeviceIsLocked=false;
function setDefaultDeviceAsActiveDeviceFn(){
	///> calls after every device action
	 activeDevice =  hub[0]["hub.envo"][0]['devices'][defMediaDeviceIndx].item;
	 avtiveDeviceIsLocked=false;
}

function newTrackPlyingFn(playStatus, trackData){

	//var clickmic = (trackData.clickmik); console.log(clickmic); ///>decodeURIComponent()

	var duration = trackData.trackDuration;
	var progress = trackData.startTime;
	var trackUID = makeUpdateNowPlayingUI(trackData, duration, progress, playStatus);

	var switchPlayIndex = (trackData.clickmickEventObj.switchPlayIndx);  ///> parseInt() // playEventType = 0 = normalPlay, playEventType>0 = switchplay
	var imgCoverURL = trackData.imgURI;
	var isQueueTrack =   trackData.clickmickEventObj.isQueueTrack; console.log("isQueueTrack: "+isQueueTrack);
	var playWasASwitchPlay=trackData.clickmickEventObj.playWasASwitchPlay; //console.log("playWasASwitchPlay: "+playWasASwitchPlay);

	////>>> for 'toPlayOrToSwitchPlay' calculation [currently not in Use]
	//var mSepPer = parseFloat($(".ui-slider-bg")[0].style.width);
	//var nSec = nowPlaySec;

	//console.log("Ori: "+ switchPlayIndex); 	///console.log("trackIdInPlaylist: "+ trackData.trackIDInPlaylist);
	
	///> finding out if next item-block need to Remove or Keep the frist-item block (if kepd it will stay in 2nd)
	if(qPlaylistObj.item.length>1 && qPlaylistObj.item[0].webUID.includes(trackUID)===false){
	console.log("switchPlayIndex: "+switchPlayIndex);

		//if(qTrackNextType.includes("Queue") || qTrackNextType.includes("playlistBlockQueue")  ///> || qPlaylistObj.item[0].playlistUID===playlistUID ///> mediaType.includes("Queue")

		if( isQueueTrack === true ) //>|| switchPlayIndex >0
		{
				if(switchPlayIndex===0){ ///> playing next qTrack
						$slyFrameObj.remove(0);
						qPlaylistObj.item.splice(0, 1); ///> removing first[0] array
						qPlaylistObj.item[0].trackDuration = duration;
						console.log('[0] Qitem Remove Done!');

				}else{  ///> playing next nTh qTrack
					var itemSwitchIndx = switchPlayIndex;//+1
					console.log("af+1 "+ itemSwitchIndx);
					$slyFrameObj.moveBefore(itemSwitchIndx,0);
					//$slyFrame.sly("reload");
					qPlaylistObj.item.move(switchPlayIndex, 0);

					//if(nSec>30 && mSepPer < 92 ) { }else{ ///> 'toPlayOrToSwitchPlay'
					if(playWasASwitchPlay === false){
						$slyFrameObj.remove(1);
						qPlaylistObj.item.splice(1, 1);

					}else { /// (it a swithPlay)
						makeLastPlayedAQueueTrack(1);
					}
					qPlaylistObj.item[0].trackDuration = duration; ///> TEMP!!
				}
		}else {///>TEST!!! [for New Track from outsite qPlayeing or playing from next 'playlistBlockQueue' ]
				insertASlyItem(trackData, 0);
				///ToPlayOrToSwitchPlay
				//if(nSec>30 && mSepPer < 92  ) { }else{ //> && qPlaylistObj.item[0].playlistUID!==playlistUID ///> 'toPlayOrToSwitchPlay'
				if(playWasASwitchPlay=== false){
					var lastPlayedTrackWebUID = qPlaylistObj.item[0].webUID;
					$slyFrameObj.remove(1);
					qPlaylistObj.item.splice(1, 1);

					qPlaylistObj.item[0].trackDuration = duration;
						///>TEST>
						if(qPlaylistObj.item[0].playlistUID===qPlaylistObj.item[1].playlistUID &&  qPlaylistObj.item[0].webUID===lastPlayedTrackWebUID ) //> && qPlaylistObj.item[0].trackType.includes("Queue")===false ///> updating 'toPlayOrToSwitchPlay'
						{qPlaylistObj.item[1].webUID=qPlaylistObj.item[0].webUID;}

					}else { /// (it a swithPlay) [playing New Track from outsite qPlayeing]
						//console.log("new outside play > duratuion : "+ duration);
						qPlaylistObj.item[0].trackDuration = duration;
						makeLastPlayedAQueueTrack(1);
					}
		}

		}
}

function makeUpdateNowPlayingUI(trackData, duration, progress, playStatus){

	var mediaType= trackData.trackType;
	var trackUID=trackData.webUID; ///> matches the character "'" literally
	var playlistUID=trackData.playlistUID;
	var trackName= unescape(trackData.trackTitle); ///> '\+' matches the character '+' literally & replace with space
	var trackArtist= unescape(trackData.trackArtist); ///.replace(/%27/g, /'/)

	//console.log("trackUID: "+trackUID + " & Qi: "+ qPlaylistObj.item[0].webUID);


	var imgURI = getThumbnailURI(trackData.imgURI, mediaType, trackUID, trackName); ///imgCoverURL

	$('div.nowPlayingTrackPrv #fileName p').text(trackName);
	$('div.nowPlayingTrackPrv .artistName p').text(trackArtist);
	$('div.nowPlayingTrackPrv #thumbnailImg img').attr("src",imgURI);

	var clickmicStr = trackData.id+","+mediaType+","+trackUID+","+playlistUID+","+trackName+","+trackArtist;
	$('div.nowPlayingTrackPrv #thumbnailImg img').attr("clickmick", clickmicStr);

	if(mediaType.includes('Audio')|| mediaType.includes('spotify')){ $('div.nowPlayingTrackPrv #thumbnailImg img').width(60);} ///95:150
	else{$('div.nowPlayingTrackPrv #thumbnailImg img').width(105);}; ///95:150
	
	sliderProgressSetupFn(playStatus, duration, progress);

	console.log(mediaType);

	return trackUID;
}

function makeLastPlayedAQueueTrack(nthQ){
	if(qPlaylistObj.item[nthQ].trackType.includes("Queue")===false){
	console.log('adding Queue srt on switchPlay!');
	///> makeing last played track a 'queue' type
	var trackType= qPlaylistObj.item[nthQ].trackType+"Queue";
	qPlaylistObj.item[nthQ].trackType=trackType;
	///..qPlaylistObj.item[1].startTime=nowPlaySec; ///> saveing nowTime in 2nt qPlaylistObj.item as its a switch play
	}
}

function onPageLoadNowplayingResumeUIState(){

	var cmik = $(".clearfix li:first").attr("clickmick");
		if (typeof qPlaylistObj.item[0].trackDuration !== "undefined"){
		var durationSec =  qPlaylistObj.item[0].trackDuration;
		}else{
			var durationSec =0;
		}
	var startTime= qPlaylistObj.item[0].startTime;
	makeUpdateNowPlayingUI(cmik,durationSec,startTime, "paused");
}

function queuedTracksLoadOnStageFn(messageData){

	$('.clearfix').html('');
	//qPlaylistObj.playerData={};
	qPlaylistObj.item=[];
	for (i = 0; i < messageData.length; i++) {
		//// var clickmic = (messageData[i].clickmik); ///> decodeURIComponent()
		var itemBlock = makeSlyItemHTML(messageData[i], i);
		$slyFrameObj.add(itemBlock);
	}
	localStorage.setObject('qPlaylsitJSON',qPlaylistObj);
}

function imgErrorSly(image, imgWidth) {
	image.onerror = "";
	//console.log(imgWidth);
	let imgFile = ( imgWidth == 99 ? 'logo_1': 'logo_2');
    image.src = basePath+'/assets/img/'+imgFile+'.jpg'; //"http://i.ytimg.com/vi/QOngRDVtEQI/mqdefault.jpg";
    return true;
}

function insertASlyItem(clickmic, position){
	var itemBlock = makeSlyItemHTML(clickmic, position);
	$slyFrameObj.add(itemBlock, position);
}

function makeSlyItemHTML(trackData, pos){///> alos making 'qPlaylistObj'

		var mediaType= trackData.trackType;
		var trackUID=trackData.webUID; ///> matches the character "'" literally
		//var playlistUID=trackData.playlistUID;
		var trackName=trackData.trackTitle; ///> '\+' matches the character '+' literally & replace with space
		//var trackArtist=trackData.trackArtist; ///.replace(/%27/g, /'/)
		//let startTime =trackData.startTime;
		//let trackDuration =trackData.trackDuration;
		var imgURI = getThumbnailURI(trackData.imgURI, mediaType, trackUID, trackName);
		trackData.imgURI=imgURI;

		var imgWidth=178;
		if(mediaType.includes('Audio') || mediaType.includes('spotify') || mediaType.includes('playlistBlock')){  imgWidth=99; } ///95:150
		trackData.imgWidth=imgWidth;
		trackData.createdDate = Date.now();
		//>> var item ={"id":"", "trackType":mediaType,"webUID": trackUID, "playlistUID":playlistUID, "trackTitle":trackName, "trackArtist":trackArtist, "imgURI":imgURI, "imgWidth":imgWidth, "startTime":startTime, "trackDuration":trackDuration};
		qPlaylistObj.item.splice(pos, 0, trackData);

		/////////> var clickmicStr = trackData.id+","+mediaType+","+trackUID+","+playlistUID+","+trackName+","+trackArtist; ///>clickmick=\""+clickmicStr+"\"
	return itemBlock =  "<li ><span id=\"slyImgBlock\"><span class=\"slyImgOverlay\"><div class=\"overlayBoxBtn\"><span class=\"flexChildTop playBtn\"></span></div><div class=\"overlayBtnContainer\"><span class=\"flexChild\"><div class=\"delBtn\"></div></span><span class=\"flexChild\"><div class=\"playSlyBtn\"></div></span>   <span class=\"flexChild\"><div class=\"optBtn\">...</div></span> </div></span><img src=\""+imgURI+"\" class=\"qItemImg\"  style=\"width:"+imgWidth+"px;\" onerror=\"javascript:imgErrorSly(this,"+imgWidth+");\" ></span></li>";

}

function makeSlyHTMLFromQPlayerObj(qPlayObj){

	$('.clearfix').html('');
	for (i = 0; i < qPlayObj.item.length; i++) {
		var trackUID = qPlayObj.item[i].webUID;
		var mediaType=qPlayObj.item[i].trackType;
		var trackName = encodeURIComponent(qPlayObj.item[i].trackTitle);
		var trackArtist = encodeURIComponent(qPlayObj.item[i].trackArtist);
		//var clickmic = qPlayObj.item[i].id+","+mediaType+","+qPlayObj.item[i].webUID+","+qPlayObj.item[i].playlistUID+","+trackName+","+trackArtist;
		var imgURI = qPlayObj.item[i].imgURI;
		var imgWidth=qPlayObj.item[i].imgWidth;

		//var itemBlock =  "<li clickmick=\""+clickmic+"\"><img src=\""+imgURI+"\" class=\"qItemImg\"  style=\"width:"+imgWidth+"px;\" ></li>"; //>>clickmick=\""+clickmic+"\"
	var itemBlock =  "<li ><span id=\"slyImgBlock\"><span class=\"slyImgOverlay\"><div class=\"overlayBoxBtn\"><span class=\"flexChildTop playBtn\"></span></div><div class=\"overlayBtnContainer\"><span class=\"flexChild\"><div class=\"delBtn\"></div></span><span class=\"flexChild\"><div class=\"playSlyBtn\"></div></span>   <span class=\"flexChild\"><div class=\"optBtn\">...</div></span> </div></span><img src=\""+imgURI+"\" class=\"qItemImg\"  style=\"width:"+imgWidth+"px;\" onerror=\"javascript:imgErrorSly(this,"+imgWidth+");\" ></span></li>";
		$slyFrameObj.add(itemBlock);
	}
}


function getClickmickData(elementItem, dragStartIndx)
		{
			var me = qPlaylistObj.item[dragStartIndx];
				var cm = elementItem.attr( "clickmick" ).split(',');
				var startEndTime = me.startTime+"|0";
				var mediaType=me.trackType;
				var trackUID = cm[2]; //escape(me.webUID);
				var playlistUID = cm[3]; //escape(me.playlistUID);
				var trackName = encodeURIComponent(me.trackTitle);
				var trackArtist = encodeURIComponent(me.trackArtist);
				return itemCmik = startEndTime+","+mediaType+","+trackUID+","+playlistUID+","+trackName+","+trackArtist; ///$item.attr( "clickmick" );
     }

function slySelectedItemAction(actionName, param=0){
	///> active (selected) sly item action from CMD
	var activeEle=$('.clearfix li.active');
	var activeSlyItemIndx =activeEle.index();
	qPlaylistObj.lastUpdateTime = Date.now();
	var itemData = qPlaylistObj.item[activeSlyItemIndx];

	switch(actionName){
		case 'moveToPlayNext':
			var insertPosition = 1;
			if(activeSlyItemIndx !==insertPosition){
			$(activeEle).insertAfter("ul.clearfix li:nth-child("+insertPosition+")"); ///"ul.clearfix li:nth-child("+(activeSlyItemIndx+1)+")"
			$slyFrameObj.reload();
			qPlaylistObj.item.move(activeSlyItemIndx, insertPosition);
			//>syncNex
			//var itemData = $(activeEle).attr("clickmick");
			$syncNexusObj.qPlaylistItemMoveEvent(itemData,activeSlyItemIndx,insertPosition);
			}
		break;
		case 'delete':
			$(activeEle).stop().fadeOut(300, function(){$slyFrameObj.remove(activeSlyItemIndx);});
			qPlaylistObj.item.splice(activeSlyItemIndx, 1); ///> removing first[0] array
			//>syncNex
			//var itemData = $(activeEle).attr("clickmick");
			$syncNexusObj.qPlaylistItemRemoveEvent(itemData,activeSlyItemIndx);
		break;
		case 'playSlyItem':
		var insertBeforePosition = 1;
		$(activeEle).insertBefore("ul.clearfix li:nth-child("+insertBeforePosition+")");
		$slyFrameObj.reload();
		//>syncNex
		qPlaylistObj.item.move((activeSlyItemIndx), (0));
		makeLastPlayedAQueueTrack(1);
		visitorData.clickOn = "playSlyItem";
		//getClickmickData(activeEle, 0); //$(activeEle).attr("clickmick");
		$syncNexusObj.qPlaylistItemMoveEvent(itemData,activeSlyItemIndx,0); ///> 0 = triggers Play
		break;
	}

	///TODO: Work with '$syncNexusObj' Obj as shown bellow Code for 'moveToPlayNext'
	///> var itemCmik = "0"+","+mediaType+","+trackUID+","+playlistUID+","+trackName+","+trackArtist; ///$item.attr( "clickmick" );
	///> $syncNexusObj.qPlaylistItemMoveEvent(itemCmik,dragStartIndx,indxDrop);


localStorage.setObject('qPlaylsitJSON',qPlaylistObj);
}

var dragStartIndx=-1;
var dragAdjustment;
var slySortable = $("ul.clearfix").sortable({
	group: 'clearfix',
	delay:100,
	distance:0,
	tolerance:-5,
 onDrop: function  ($item, container, _super) {

	 var $clonedItem = $('<li/>').css({height: 0});
		 $item.before($clonedItem);
		 $clonedItem.offset({ left: $clonedItem.offset().left +$slyFrameObj.pos.dest });
		 $clonedItem.animate({'height': $item.height()});

		 $item.animate($clonedItem.position(), function  () {
				 $clonedItem.detach();
				 _super($item, container);

				var indxDrop = $item.index();
				console.log(indxDrop);

				if(dragStartIndx!==indxDrop){ ///> if not dropped in same place

				$slyFrameObj.reload();

				//var itemCmik = getClickmickData($item, dragStartIndx);
				let trackData= qPlaylistObj.item[indxDrop];

				qPlaylistObj.item.move((dragStartIndx), (indxDrop));
 				qPlaylistObj.lastUpdateTime = Date.now();

				/// TODO: Run 'makeLastPlayedAQueueTrack' Fn when playing new Track from outside 'QPlaylist' and make nowPlayling a 'Queue' track
				if(indxDrop===0){	makeLastPlayedAQueueTrack(1);}
				$syncNexusObj.qPlaylistItemMoveEvent(trackData,dragStartIndx,indxDrop);

			}

			if(userAgent.mobileDevice){ ///> TODO:
			slySortable.sortable('disable');
			$slyFrameObj.options.touchDragging=1;
			//$slyFrameObj.options.mouseDragging=1;
			}
			dragStartIndx=-1;

		 	});
 },
 onDragStart: function($item, container, _super) {
		  dragStartIndx = $item.index();
		 console.log(dragStartIndx);
		///>> $('ul.clearfix li:nth-child('+dragStartIndx+')').after( "<b style='position: relative;float:left;'><li>Hello1</li></b><li></li><b style='position: relative;float:left;'><li>Hello2</li></b>" );
		 var offset = $item.offset(),
			 pointer = container.rootGroup.pointer;

		 dragAdjustment = {
			 left: pointer.left - (offset.left+$slyFrameObj.pos.dest),
			 top: pointer.top - offset.top
		 };

		 _super($item, container);
},
		  onDrag: function ($item, position) {
			$item.css({
			  left: position.left - dragAdjustment.left,
			  top: position.top - dragAdjustment.top
			});
		  }
});

////>------------XXXXXX
function getThumbnailURI(imgURI, mediaType, mediaURL, mediaTitle){
	
	//console.log(imgURI);
	if(mediaType.includes("youtube")==true){ return imgURI= 'https://i.ytimg.com/vi/' + getYTIDFromURL(mediaURL)+'/mqdefault.jpg';	 }
	else if(imgURI!==""){ return imgURI;}
	
	// else if(mediaType.includes("Video")==true){	var imageThumb = encodeURIComponent(mediaTitle).replace(/'/g, "%27"); return imgURI ='http://$localhost:$port/images/' + imageThumb + '.jpg';}
	// else if(mediaType.includes("spotify")==true){ return imgURI ='http://$localhost:$port/images/spotify_3.png';}
	
	// else if(mediaType.includes("Audio")==true){ return imgURI= 'http://$localhost:$port/images/logo_1.jpg';	 } ///.mp3.jpg
	// else if(mediaType.includes("playlistBlockQueue")===true){return imgURI= 'http://$localhost:$port/images/logo_list_2.jpg';	};
	
	
}

$(function(){
		$("#search-mini").focusout(function(){
			if(typeof $.myinputText === 'undefined' || $.myinputText===""){ ///> cmdTriggerOn===false
		    $('#conPanel').hide();
			}
		});

		$( "#search-mini" ).focus(function() {
		 // $('#conPanel').show();
		});

		$( "#search-mini" ).click(function() {
		  $('#conPanel').show();
		});

		///> slider mark JS
		$( ".ui-slider.ui-mini" ).mousemove(function( e ) {

			sliderMouseMove(e);

		});

	$( "div#timeSliderArrowBox" ).mousemove(function( e ) {

		sliderMouseMove(e);

		});

	var timeSecPoint ;
	function sliderMouseMove(e){
		var relX = e.pageX;  // - parentOffset.left;
		var widthMid = document.getElementById('timeSliderArrowBox').offsetWidth/2;

		 var pointVal=relX-widthMid;
		 $('#timeSliderArrowBox').css('left', pointVal);

		 var pointerInBrPos= relX-$( ".ui-slider-track.ui-shadow-inset" ).offset().left;

		 var posPer = pointerInBrPos/$(".ui-slider.ui-mini").width()*mediaDurationInSec;
		 //  console.log(posPer);
		  timeSecPoint =posPer;

		var result = toHHMMSS(timeSecPoint);
		$("p.timePop").html(result);
	}

	$( ".ui-slider.ui-mini" ).mousedown(function( e ) {sliderWideClick(e);});

	function sliderWideClick(e){
		e.preventDefault();
		if(e.target !== e.currentTarget) return;
		console.log('mouse-down!!');
		switch (e.which) {
			case 1: ///> left click
			nowPlaySec = timeSecPoint ;
			$("#show_sliderbar #slider-mini").val(nowPlaySec).slider("refresh");
			activeDevice.goToSecPlay();
			break;
		}
		return false;
	}

		$( ".ui-slider.ui-mini" ).mouseenter(function() {
		 $("#timeSliderArrowBox").show();
		});

		$( "#info" ).mouseleave(function() {
		 $("#timeSliderArrowBox").hide();
		});

	if(userAgent.mobileDevice){

		slySortable.sortable('disable');
		$('body').on('mousedown', 'ul.clearfix li', function(e) {
			    clearTimeout(this.downTimer);
			    this.downTimer = setTimeout(function() {
			        //alert('mousedown > 2 sec');
							$slyFrameObj.options.touchDragging=0;
							//$slyFrameObj.options.mouseDragging=0;
							slySortable.sortable('enable');

			    },600);
			}).mouseup(function(e) {
				//alert('mouseUP!! > 2 sec');
				slySortable.sortable('disable');
				$slyFrameObj.options.touchDragging=1;
				//$slyFrameObj.options.mouseDragging=1;
			    clearTimeout(this.downTimer);
			});

	} ///> mobile function ends
	else{


	//$( ".slyWrap" ).mouseenter(function() { $('.qItemImg').css('opacity', '0.8');});
	var timeoutIdSlyImgOpa;
     $(".slyWrap").hover(function() { ///> #masterFooter >> .ui-slider
			// console.log(' hover!! on : .ui-slider');
		
         if (!timeoutIdSlyImgOpa) {
			timeoutIdSlyImgOpa = window.setTimeout(function() {
				timeoutIdSlyImgOpa = null;
				
                if($('.slyWrap').is(':visible')){$('.qItemImg').fadeTo( "fast", 0.8 );}
            }, 200);
         }
     },
     function () {
         if (timeoutIdSlyImgOpa) {
             window.clearTimeout(timeoutIdSlyImgOpa);
             timeoutIdSlyImgOpa = null;
         }
         else {

         }
	 });
	 
	$( ".slyWrap" ).mouseleave(function() { $('.qItemImg').fadeTo( "fast", 0.4 );}); ///>.css('opacity', '0.4');

	}


	var timeoutId;
	var eleHvrClass;
	//var panelPinned=false;
     $(".playControlBox, #info").hover(function(e) { ///> #masterFooter >> .ui-slider
			// console.log(' hover!! on : .ui-slider');
			//if(e.target !== e.currentTarget) return;
			 eleHvrClass=e.target.className;
			// console.log(eleHvrClass);
         if (!timeoutId) {
             timeoutId = window.setTimeout(function() {
                 timeoutId = null;
				 progBarOpaUp();
				if($('.slyWrap').is(':visible')===false){$('.slyWrap').fadeIn(); $slyFrameObj.reload(); }
				if(webMediaPlayerMasterObj.playerStatus===1 && eleHvrClass==="playControlBox flexChild" && $("#swipebox-overlay").hasClass("miniPlayScreen")===false){setTimeout(function(){ if(eleHvrClass==="playControlBox flexChild"){hideSlyPanel();} }, 2000);}
				
            }, 400);
         }
     },
     function () {
         if (timeoutId) {
             window.clearTimeout(timeoutId);
             timeoutId = null;
         }
         else {

         }
     });

		 $('#masterFooter').mouseleave(function(){
			if(dragStartIndx<0){hideSlyPanel();}
		 });



$('body').on('tap', 'div.nowPlayingTrackPrv .nowTrackInfo', slyPanelViewShow );
$('body').on('tap', 'div.nowPlayingTrackPrv #thumbnailImg img', slyPanelViewShow );

	function showFlexInfoBar(message){
		if($("#info").is(":visible")===false){
			$("#info").fadeIn("fast", function(){ showInfo('flexInfoBar');});
		}
		$("#flexInfoBar").text(message);
	}




  });

//> PWA service-worker
// This is the "Offline page" service worker
// Add this below content to your HTML page, or add the js file to your page at the very top to register service worker
// Check compatibility for the browser we're running this in
// if ("serviceWorker" in navigator) {
//   if (navigator.serviceWorker.controller) {
//     console.log("[PWA Builder] active service worker found, no need to register");
//   } else {
//     // Register the service worker
//     navigator.serviceWorker
//       .register("pwabuilder-sw.js", {
//         scope: "./"
//       })
//       .then(function (reg) {
//         console.log("[PWA Builder] Service worker has been registered for scope: " + reg.scope);
//       });
//   }
// }


</script>


<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/velocity/1.5.0/velocity.min.js"></script> -->

</body>


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-292610-18"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-292610-18');
</script>

<!-- <script>
// Google Analytics
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

	ga('create', 'UA-292610-17', 'auto');
	ga('send', 'pageview');

</script> -->
