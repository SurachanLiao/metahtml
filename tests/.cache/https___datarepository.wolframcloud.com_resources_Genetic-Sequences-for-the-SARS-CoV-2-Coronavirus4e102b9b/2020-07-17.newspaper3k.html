<div><h3>Basic Examples</h3><p class="example-text">Get a <a class="reflink" href="https://reference.wolfram.com/language/ref/Dataset.html">Dataset</a> containing rows for each sequence:</p>In[1]:=<img src="https://www.wolframcloud.com/obj/resourcesystem/images/873/8738b472-f1d1-462b-ac34-e9684a4dc088/2809a5d3f745214f.png" alt='ResourceData["Genetic Sequences for the SARS-CoV-2 Coronavirus"]' width="436" height="19">Out[1]=<img src="https://www.wolframcloud.com/obj/resourcesystem/images/873/8738b472-f1d1-462b-ac34-e9684a4dc088/79ed2c4750120deb.png" width="1229" height="302"><p class="example-text">Return the latest date a sequence was included:</p>In[2]:=<img src="https://www.wolframcloud.com/obj/resourcesystem/images/873/8738b472-f1d1-462b-ac34-e9684a4dc088/305f5d59b968fbd8.png" alt='ResourceData[
  "Genetic Sequences for the SARS-CoV-2 Coronavirus"][Max, \
"InclusionDate"]' width="578" height="19">Out[2]=<img src="https://www.wolframcloud.com/obj/resourcesystem/images/873/8738b472-f1d1-462b-ac34-e9684a4dc088/024c6be0c6f557db.png" width="142" height="24"><p class="example-text">Count the different lengths of sequences provided, which corresponds well to the part of the virus that was sequenced:</p>In[3]:=<img src="https://www.wolframcloud.com/obj/resourcesystem/images/873/8738b472-f1d1-462b-ac34-e9684a4dc088/4e2c2a0485484f24.png" alt='ResourceData["Genetic Sequences for the SARS-CoV-2 Coronavirus"][
  Counts, "Length"][ReverseSort]' width="558" height="43">Out[3]=<img src="https://www.wolframcloud.com/obj/resourcesystem/images/873/8738b472-f1d1-462b-ac34-e9684a4dc088/0aa372fd993381c8.png" width="201" height="310"><p class="example-text">The lengths of sequences break down into two categories, corresponding to more complete sequences versus specific genetic regions:</p>In[4]:=<img src="https://www.wolframcloud.com/obj/resourcesystem/images/873/8738b472-f1d1-462b-ac34-e9684a4dc088/44d95b0245231fbf.png" alt='ResourceData[
  "Genetic Sequences for the SARS-CoV-2 Coronavirus"][Histogram, \
"Length"]' width="510" height="43">Out[4]=<img src="https://www.wolframcloud.com/obj/resourcesystem/images/873/8738b472-f1d1-462b-ac34-e9684a4dc088/08db3058899091e9.png" width="360" height="214"><p class="example-text">Most of these SARS-CoV-2 samples are collected from humans, but not all:</p>In[5]:=<img src="https://www.wolframcloud.com/obj/resourcesystem/images/873/8738b472-f1d1-462b-ac34-e9684a4dc088/41105ef8af0ca1ab.png" alt='ResourceData["Genetic Sequences for the SARS-CoV-2 Coronavirus"][
  Select[Not[MissingQ[#Host]] &amp;]][Counts, "Host"]' width="440" height="43">Out[5]=<img src="https://www.wolframcloud.com/obj/resourcesystem/images/873/8738b472-f1d1-462b-ac34-e9684a4dc088/1c7a78263e043770.png" width="162" height="164"><h3>Scope &amp; Additional Elements</h3><p class="example-text">Get a date histogram of collection dates:</p>In[6]:=<img src="https://www.wolframcloud.com/obj/resourcesystem/images/873/8738b472-f1d1-462b-ac34-e9684a4dc088/2a5d4c7882a95bd2.png" alt='ResourceData["Genetic Sequences for the SARS-CoV-2 Coronavirus", \
"CollectionHistogram"]' width="586" height="19">Out[6]=<img src="https://www.wolframcloud.com/obj/resourcesystem/images/873/8738b472-f1d1-462b-ac34-e9684a4dc088/3322c1ecef49a546.png" width="360" height="218"><p class="example-text">See a date histogram of release dates:</p>In[7]:=<img src="https://www.wolframcloud.com/obj/resourcesystem/images/873/8738b472-f1d1-462b-ac34-e9684a4dc088/5fa1ea3d95f19e5a.png" alt='ResourceData["Genetic Sequences for the SARS-CoV-2 Coronavirus", \
"ReleaseHistogram"]' width="572" height="19">Out[7]=<img src="https://www.wolframcloud.com/obj/resourcesystem/images/873/8738b472-f1d1-462b-ac34-e9684a4dc088/784e0c523fee885c.png" width="360" height="222"><p class="example-text">See a date histogram of inclusion dates:</p>In[8]:=<img src="https://www.wolframcloud.com/obj/resourcesystem/images/873/8738b472-f1d1-462b-ac34-e9684a4dc088/6e9df9831fa008f2.png" alt='ResourceData["Genetic Sequences for the SARS-CoV-2 Coronavirus", \
"InclusionHistogram"]' width="580" height="19">Out[8]=<img src="https://www.wolframcloud.com/obj/resourcesystem/images/873/8738b472-f1d1-462b-ac34-e9684a4dc088/1f3356efe321ff56.png" width="360" height="222"><p class="example-text">Show the locations where the sequences were gathered:</p>In[9]:=<img src="https://www.wolframcloud.com/obj/resourcesystem/images/873/8738b472-f1d1-462b-ac34-e9684a4dc088/3fc22f1d75876a1b.png" alt='ResourceData["Genetic Sequences for the SARS-CoV-2 Coronavirus", \
"AffectedLocations"]' width="570" height="19">Out[9]=<img src="https://www.wolframcloud.com/obj/resourcesystem/images/873/8738b472-f1d1-462b-ac34-e9684a4dc088/388bd6fdcd5d4e95.png" width="575" height="288"><p class="example-text">Obtain the available alignment differences with the reference sequence:</p>In[10]:=<img src="https://www.wolframcloud.com/obj/resourcesystem/images/873/8738b472-f1d1-462b-ac34-e9684a4dc088/285981b8927b637c.png" alt='ResourceData["Genetic Sequences for the SARS-CoV-2 Coronavirus", \
"AlignmentDifferences"]' width="592" height="19">Out[10]=<img src="https://www.wolframcloud.com/obj/resourcesystem/images/873/8738b472-f1d1-462b-ac34-e9684a4dc088/45eb87c484f86c95.png" width="575" height="328"><h3>Visualizations</h3><p class="example-text">A phylogenetic tree comparison of the most-common complete genomes by location shows clusters that are broadly distributed.  Dropping the trailing sequences of adenine terms avoids arbitrary differences from varying poly(A) RNA tail lengths, which may be sequencing artifacts and shouldn&amp;CloseCurlyQuote;t affect viral adaptivity:</p>In[11]:=<img src="https://www.wolframcloud.com/obj/resourcesystem/images/873/8738b472-f1d1-462b-ac34-e9684a4dc088/6b75fda403519bda.png" alt='dropTrailingA[seq_] := StringReplace[seq, StartOfString ~~ Shortest[a__] ~~ ("A" ..) ~~ EndOfString :&gt; a];
sampleListFirstByMostCommon[lists : {___List}] := DeleteCases[
   Prepend[#[[1, 2 ;; -1]], ReverseSortBy[Tally[First /@ #], Last][[1, 1]]] &amp; /@ GatherBy[lists, Rest], {_, _Missing}];
treePlot = Apply[ResourceFunction["PhylogeneticTreePlot"], Transpose[{dropTrailingA@First[#], Row@(Rest@#)} &amp; /@ sampleListFirstByMostCommon[{#[[1]], #[[2]]} &amp;@*Values /@ Normal[ResourceData[
         "Genetic Sequences for the SARS-CoV-2 Coronavirus"][
        Select[And[
           StringContainsQ[#GenBankTitle, "complete genome"], #Host ===
             Entity["Species", "Species:HomoSapiens"]] &amp;], {"Sequence", "GeographicLocation"}]]]]
  ]' width="570" height="381">Out[12]=<img src="https://www.wolframcloud.com/obj/resourcesystem/images/873/8738b472-f1d1-462b-ac34-e9684a4dc088/7a24f62770487bb9.png" width="575" height="620">In[13]:=<img src="https://www.wolframcloud.com/obj/resourcesystem/images/873/8738b472-f1d1-462b-ac34-e9684a4dc088/6bc61cee31d55636.png" alt='GeoGraphics[{MapIndexed[
   Splice[{ColorData[81][#2[[1]]], Splice[Polygon /@ #1]}] &amp;,
   {{
Entity["Country", "Chile"], 
Entity["Country", "China"], 
Entity["Country", "Egypt"], 
Entity["Country", "Finland"], 
Entity["Country", "Georgia"], 
Entity["Country", "Germany"], 
Entity["Country", "Nepal"], 
Entity["Country", "NewZealand"], 
Entity["Country", "Pakistan"], 
Entity["Country", "Spain"], 
Entity["Country", "Tunisia"]}, {
Entity["Country", "CzechRepublic"], 
Entity["Country", "Greece"], 
Entity["Country", "Japan"], 
Entity["Country", "Kazakhstan"], 
Entity["Country", "Netherlands"], 
Entity["Country", "Nigeria"], 
Entity["Country", "Peru"], 
Entity["Country", "Poland"], 
Entity["Country", "Russia"], 
Entity["Country", "Serbia"], 
Entity["Country", "Turkey"]}, {
Entity["Country", "Australia"], 
Entity["Country", "Bahrain"], 
Entity["Country", "Israel"], 
Entity["Country", "PuertoRico"], 
Entity["Country", "SouthAfrica"], 
Entity["Country", "UnitedStates"], 
Entity["Country", "Uruguay"], 
Entity["Country", "Vietnam"]},
    {
Entity["Country", "Iran"], 
Entity["Country", "Taiwan"]}, {
Entity["Country", "EastTimor"], 
Entity["Country", "Guam"], 
Entity["Country", "Jamaica"], 
Entity["Country", "Malaysia"], 
Entity["Country", "SouthKorea"], 
Entity["Country", "Sweden"]}, {
Entity["Country", "Bangladesh"], 
Entity["Country", "Brazil"], 
Entity["Country", "Colombia"], 
Entity["Country", "France"], 
Entity["Country", "Morocco"], 
Entity["Country", "SriLanka"]}, Splice[List /@ {
Entity["Country", "HongKong"], 
Entity["Country", "Thailand"], 
Entity["Country", "Italy"], 
Entity["Country", "India"], 
Entity["Country", "SaudiArabia"]}]}]}]' width="537" height="111">Out[13]=<img src="https://www.wolframcloud.com/obj/resourcesystem/images/873/8738b472-f1d1-462b-ac34-e9684a4dc088/1e9b1de1525c10ff.png" width="575" height="288"><p class="example-text">A similar visualization can be created for samples where more detailed geographic information is supplied. In this visualization of most-common sequences reported for US states, we see the emergence of clusters containing interesting regional blocks as shown in the map below:</p>In[14]:=<img src="https://www.wolframcloud.com/obj/resourcesystem/images/873/8738b472-f1d1-462b-ac34-e9684a4dc088/06380509cf5a9d76.png" alt='Apply[ResourceFunction["PhylogeneticTreePlot"], Transpose[{dropTrailingA@First[#], Last[#]} &amp; /@ sampleListFirstByMostCommon[{#[[1]], #[[2]]} &amp;@*Values /@ Normal[ResourceData[
        "Genetic Sequences for the SARS-CoV-2 Coronavirus"][
       Select[And[
          StringContainsQ[#GenBankTitle, "complete genome"], #Host ===
            Entity["Species", "Species:HomoSapiens"], MemberQ[#DetailedGeographicLocation["EntityClasses"], EntityClass["AdministrativeDivision", "USStateClass"]]] &amp;], {"Sequence", "DetailedGeographicLocation"}]]]]
 ]' width="554" height="329">Out[14]=<img src="https://www.wolframcloud.com/obj/resourcesystem/images/873/8738b472-f1d1-462b-ac34-e9684a4dc088/661d9b60c272f256.png" width="575" height="524">In[15]:=<img src="https://www.wolframcloud.com/obj/resourcesystem/images/873/8738b472-f1d1-462b-ac34-e9684a4dc088/01b5ba686dd494b8.png" alt='GeoGraphics[{MapIndexed[
   Splice[{ColorData[3][#2[[1]]], Splice[Polygon /@ #1]}] &amp;, {{
Entity["AdministrativeDivision", {"Virginia", "UnitedStates"}], 
Entity["AdministrativeDivision", {"Idaho", "UnitedStates"}], 
Entity["AdministrativeDivision", {"Michigan", "UnitedStates"}], 
Entity["AdministrativeDivision", {"Minnesota", "UnitedStates"}], 
Entity["AdministrativeDivision", {"Iowa", "UnitedStates"}], 
Entity["AdministrativeDivision", {"Illinois", "UnitedStates"}], 
Entity["AdministrativeDivision", {"NewYork", "UnitedStates"}], 
Entity["AdministrativeDivision", {"NewJersey", "UnitedStates"}], 
Entity["AdministrativeDivision", {"Tennessee", "UnitedStates"}], 
Entity["AdministrativeDivision", {"Nevada", "UnitedStates"}], 
Entity["AdministrativeDivision", {"Oregon", "UnitedStates"}], 
Entity["AdministrativeDivision", {"Nebraska", "UnitedStates"}], 
Entity["AdministrativeDivision", {"Oklahoma", "UnitedStates"}], 
Entity["AdministrativeDivision", {"Wisconsin", "UnitedStates"}], 
Entity["AdministrativeDivision", {"Vermont", "UnitedStates"}], 
Entity["AdministrativeDivision", {"Washington", "UnitedStates"}], 
Entity["AdministrativeDivision", {"Georgia", "UnitedStates"}], 
Entity["AdministrativeDivision", {"SouthCarolina", "UnitedStates"}], 
Entity["AdministrativeDivision", {
      "DistrictOfColumbia", "UnitedStates"}], 
Entity["AdministrativeDivision", {"Utah", "UnitedStates"}]}, {
Entity["AdministrativeDivision", {"NewHampshire", "UnitedStates"}], 
Entity["AdministrativeDivision", {"Louisiana", "UnitedStates"}], 
Entity["AdministrativeDivision", {"Ohio", "UnitedStates"}], 
Entity["AdministrativeDivision", {"Kentucky", "UnitedStates"}], 
Entity["AdministrativeDivision", {"RhodeIsland", "UnitedStates"}], 
Entity["AdministrativeDivision", {"Colorado", "UnitedStates"}], 
Entity["AdministrativeDivision", {"California", "UnitedStates"}], 
Entity["AdministrativeDivision", {"Massachusetts", "UnitedStates"}], 
Entity["AdministrativeDivision", {"Pennsylvania", "UnitedStates"}], 
Entity["AdministrativeDivision", {"Kansas", "UnitedStates"}]}, {
Entity["AdministrativeDivision", {"Missouri", "UnitedStates"}], 
Entity["AdministrativeDivision", {"Arizona", "UnitedStates"}]}, Splice[List /@ {
Entity["AdministrativeDivision", {"Connecticut", "UnitedStates"}], 
Entity["AdministrativeDivision", {"Indiana", "UnitedStates"}], 
Entity["AdministrativeDivision", {"NorthCarolina", "UnitedStates"}], 
Entity["AdministrativeDivision", {"Florida", "UnitedStates"}], 
Entity["AdministrativeDivision", {"Texas", "UnitedStates"}], 
Entity["AdministrativeDivision", {"Maryland", "UnitedStates"}]}]}]}]' width="454" height="107">Out[15]=<img src="https://www.wolframcloud.com/obj/resourcesystem/images/873/8738b472-f1d1-462b-ac34-e9684a4dc088/0f54a0818c4f921f.png" width="575" height="321"><p class="example-text">When visualizing the similarity of the most common sequence by week of sequence collection, while one does observe that similar times tend to cluster together, there is some overlap (such as between the week of Dec. 30, 2019 and the week of Feb. 17, 2020), illustrating that the virus has not only seen evolution, but significant continuity:</p>In[16]:=<img src="https://www.wolframcloud.com/obj/resourcesystem/images/873/8738b472-f1d1-462b-ac34-e9684a4dc088/2faedb5b23e8be7e.png" alt='sampleListFirstByMostCommon[lists : {___List}] := DeleteCases[
   Prepend[#[[1, 2 ;; -1]], ReverseSortBy[Tally[First /@ #], Last][[1, 1]]] &amp; /@ GatherBy[lists, Rest], {_, DateObject[_Missing, "Week"]}];
treePlot = Apply[ResourceFunction["PhylogeneticTreePlot"], Transpose[{dropTrailingA@First[#], Row@(Rest@#)} &amp; /@ sampleListFirstByMostCommon[{#[[1]], DateObject[#[[2]], "Week"]} &amp;@*Values /@ Normal[ResourceData[
         "Genetic Sequences for the SARS-CoV-2 Coronavirus"][
        Select[And[
           StringContainsQ[#GenBankTitle, "complete genome"], #Host ===
             Entity["Species", "Species:HomoSapiens"]] &amp;], {"Sequence", "CollectionDate"}]]]]
  ]' width="570" height="334">Out[17]=<img src="https://www.wolframcloud.com/obj/resourcesystem/images/873/8738b472-f1d1-462b-ac34-e9684a4dc088/1cd9b79bb308067b.png" width="575" height="467"><h3>Analysis</h3><p class="example-text">Using the provided alignment differences, we can see where along the viral genome changes have been detected over time.  We see that while mutations are relatively uniformly distributed, there are certainly changes more commonly measured than others:</p>In[18]:=<img src="https://www.wolframcloud.com/obj/resourcesystem/images/873/8738b472-f1d1-462b-ac34-e9684a4dc088/1ac59eef1d606dc2.png" alt='minDate = ResourceData["Genetic Sequences for the SARS-CoV-2 Coronavirus"][
    Select[StringContainsQ[#GenBankTitle, "complete genome"] &amp;]][Min, "CollectionDate"];
accessionToDiffList = &lt;|
   Rule @@@ Normal[Values /@ ResourceData["Genetic Sequences for the SARS-CoV-2 Coronavirus",
        "AlignmentDifferences"]]|&gt;;
ResourceData["Genetic Sequences for the SARS-CoV-2 Coronavirus", "AlignmentDifferences"];
positionCountPerCollectionDay = Sort[Flatten[
    With[{day = #[[1, 1]]}, Prepend[#, day] &amp; /@ Tally[Flatten[Last /@ #]]] &amp; /@ GatherBy[{Ceiling[
          QuantityMagnitude[
           DateDifference[minDate, #[[1]]]]], (#["Position"]) &amp; /@ accessionToDiffList[#[[2]]]} &amp; /@ Normal[Values /@ ResourceData[
            "Genetic Sequences for the SARS-CoV-2 Coronavirus"][
           Select[And[Not[MissingQ[#CollectionDate]], KeyExistsQ[accessionToDiffList, #Accession]] &amp;]
           ][[All, {"CollectionDate", "Accession"}]]],
      First], 1]];
ListPlot3D[positionCountPerCollectionDay,
 AxesLabel -&gt; {"Days of Reported Data", "Genetic Position", "Changes Counted\nat Position"}
 ]' width="604" height="489">Out[19]=<img src="https://www.wolframcloud.com/obj/resourcesystem/images/873/8738b472-f1d1-462b-ac34-e9684a4dc088/3578cb75e8f3bc12.png" width="575" height="378"><p class="example-text">It is also possible to treat these genetic differences as lists of features:</p>In[20]:=<img src="https://www.wolframcloud.com/obj/resourcesystem/images/873/8738b472-f1d1-462b-ac34-e9684a4dc088/5e4c6b9480bc8774.png" alt='diffToStringFeature[diff_Association] := ToString[diff["Position"]] &lt;&gt; ":" &lt;&gt; diff["Reference"] &lt;&gt; "&gt;" &lt;&gt; diff["Variation"];
diffToStringFeature[diffs : {___Association}] := Map[diffToStringFeature, diffs];
accessionToFeatureList = diffToStringFeature /@ accessionToDiffList;
accessionToFeatureList // Keys // First // accessionToFeatureList' width="523" height="113">Out[21]=<img src="https://www.wolframcloud.com/obj/resourcesystem/images/873/8738b472-f1d1-462b-ac34-e9684a4dc088/0131b8f57db1a313.png" width="436" height="39"><p class="example-text">By doing so, it is possible to perform a fairly wide variety of analysis.  Here, we determine all of the genetic differences that always occur together in the sampled sequences, taking advantage of the fact that when differences always occur together they must occur in the same number of sequences:</p>In[22]:=<img src="https://www.wolframcloud.com/obj/resourcesystem/images/873/8738b472-f1d1-462b-ac34-e9684a4dc088/39f6318d5fbe2aa8.png" alt='featureIndex = &lt;|
   Rule[#[[1, 1]], Last /@ #] &amp; /@ GatherBy[
     Flatten[Function[{diffList}, {#, diffList} &amp; /@ diffList] /@ Values[accessionToFeatureList], 1], First]|&gt;;
termCountIndex = &lt;|
   Rule[#[[1, 1]], Last /@ #] &amp; /@ GatherBy[{Length[featureIndex[#]], #} &amp; /@ Keys[featureIndex], First]|&gt;;
doesAlwaysCoOccur[firstTerm_, secondTerm_] := AllTrue[featureIndex[firstTerm], MemberQ[#, secondTerm] &amp;];
findCoOccurPairs[terms_List] := Module[{firstTermResults, remainingTerms = terms, firstTerm, restTerms},
  Flatten[Reap[While[remainingTerms =!= {},
      firstTerm = First[remainingTerms];
      restTerms = Rest[remainingTerms];
      firstTermResults = Rule[firstTerm, #] &amp; /@ Select[restTerms, doesAlwaysCoOccur[firstTerm, #] &amp;];
      Sow[firstTermResults];
      remainingTerms = Complement[restTerms, Last /@ firstTermResults];
      ]][[2, 1]], 1]
  ]
coOccurenceSets =
  WeaklyConnectedComponents[
   Flatten[
    findCoOccurPairs[termCountIndex[#]] &amp; /@ Keys[termCountIndex], 1]];
ResourceFunction["NiceGrid"][
 Row[Sort[#], ", "] &amp; /@ Take[coOccurenceSets, 5], Alignment -&gt; Left]' width="532" height="536">Out[23]=<img src="https://www.wolframcloud.com/obj/resourcesystem/images/873/8738b472-f1d1-462b-ac34-e9684a4dc088/70b61d7fb9080139.png" width="638" height="484"></div>